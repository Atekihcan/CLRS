<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- Legacy meta -->
    <meta name="description" content="Insertion Sort on Small Arrays in Merge Sort: Although merge sort runs in Θ(nlg⁡n) worst-case time and insertion sort runs in Θ(n^2) worst-case time, the constant factors in insertion sort can make it faster in practice for small problem sizes on many machines. Thus, it makes sense to coarsen the leaves of the recursion by using insertion sort within merge sort when subproblems become sufficiently small."/>
    <meta name="keywords" content="CLRS, solutions, algorithms, Cormen, Insertion Sort, Merge Sort, Shell Sort"/>

    <!--Schema-->
    <link rel="author" href="Atekihcan">
    <link rel="publisher" href="https://atekihcan.github.io">
    <meta itemprop="name" content="CLRS Solutions | Problem 2-1 | Getting Started"/>
    <meta itemprop="description" content="Insertion Sort on Small Arrays in Merge Sort: Although merge sort runs in Θ(nlg⁡n) worst-case time and insertion sort runs in Θ(n^2) worst-case time, the constant factors in insertion sort can make it faster in practice for small problem sizes on many machines. Thus, it makes sense to coarsen the leaves of the recursion by using insertion sort within merge sort when subproblems become sufficiently small."/>

    <!-- OpenGraph -->
    <meta property="og:title" content="CLRS Solutions | Problem 2-1 | Getting Started" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://atekihcan.github.io/CLRS/02/P02-01/" />
    <meta property="og:image" content="/CLRS/assets/img/-1/2-1.jpg" />
    <meta property="og:description" content="Insertion Sort on Small Arrays in Merge Sort: Although merge sort runs in Θ(nlg⁡n) worst-case time and insertion sort runs in Θ(n^2) worst-case time, the constant factors in insertion sort can make it faster in practice for small problem sizes on many machines. Thus, it makes sense to coarsen the leaves of the recursion by using insertion sort within merge sort when subproblems become sufficiently small." />

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "CLRS Solutions | Problem 2-1 | Getting Started",
        "image": [
            "/CLRS/assets/img/-1/2-1.jpg"
        ],
        "datePublished": "2012-08-22T23:00:00+00:00",
        "dateModified": "2020-10-07T20:30:00+00:00",
        "author": {
            "@type": "Person",
            "name": "Atekihcan"
        }
    }
    </script>
    
    <title>CLRS Solutions | Problem 2-1 | Getting Started</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="/CLRS/assets/img/favicon.png">

    <!-- Normalize reset -->
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/normalize.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Katex -->
    <link rel="stylesheet" href="/CLRS/assets/katex/katex.min.css" >
    <script defer src="/CLRS/assets/katex/katex.min.js" ></script>
    <script defer src="/CLRS/assets/katex/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {trust: true});"></script>

    <!-- Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-57470252-4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-57470252-4', {
            cookie_domain: 'https://atekihcan.github.io',
            cookie_flags: 'SameSite=None;Secure'
        });
    </script>

    <!-- Load site specific stuff at last -->
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/site.css">
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/syntax_highlight.css">

    <script defer src="/CLRS/assets/js/site.js" ></script>
</head>
    <body class="site-body">
        <header class="site-header">
    <nav>
        <i class="fa fa-database"></i>&nbsp;&nbsp;<a href="/CLRS/">Solutions for CLRS</a>&nbsp;&nbsp;<i class="fa fa-database"></i>
    </nav>
    <h1 class="page-title">
        Problem 2-1
    </h1>
</header>
        <main class="site-main">
            <article>
    <div class="article-content">
        <blockquote>
  <p><strong><em>Insertion Sort on Small Arrays in Merge Sort</em></strong></p>

  <p>Although merge sort runs in \(\Theta(n \lg n)\) worst-case time and insertion sort runs in \(\Theta(n^2)\) worst-case time, the constant factors in insertion sort can make it faster in practice for small problem sizes on many machines. Thus, it makes sense to <strong><em>coarsen</em></strong> the leaves of the recursion by using insertion sort within merge sort when subproblems become sufficiently small. Consider a modification to merge sort in which \(n/k\) sublists of length \(k\) are sorted using insertion sort and then merged
using the standard merging mechanism, where \(k\) is a value to be determined.</p>

  <ol>
    <li>Show that insertion sort can sort the \(n/k\) sublists, each of length \(k\), in \(\Theta(n \lg (n/k))\) worst-case time.</li>
    <li>Show how to merge the sublists in \(\Theta(n \lg(n/k))\) worst-case time.</li>
    <li>Given that the modified algorithm runs in \(\Theta(nk + n \lg(n/k))\) worst-case time, what is the largest value of k as a function of n for which the modified algorithm has the same running time as standard merge sort, in terms of \(\Theta\) notation?</li>
    <li>How should we choose \(k\) in practice?</li>
  </ol>
</blockquote>

<h4 id="sorting-sublists">Sorting Sublists</h4>

<p>For input of size \(k\), insertion sort runs on \(\Theta(k^2)\) worst-case time. So, worst-case time to sort \(n/k\) sublists, each of length \(k\), will be \(n/k \cdot \Theta(k^2) = \Theta(nk)\)</p>

<h4 id="merging-sublists">Merging Sublists</h4>

<p>We have \(n\) elements divided into \(n/k\) sorted sublists each of length \(k\). To merge these \(n/k\) sorted sublists to get a single sorted list of length \(n\), we have to take 2 sublists at a time and continue to merge them.</p>

<p>This will result in \(\lg (n/k)\) steps (refer to Figure 2.5 in page 38 of the chapter text). And in every step, we are essentially going to compare \(n\) elements. So the whole process will run at \(\Theta(n \lg (n/k))\).</p>

<h4 id="largest-value-of-k">Largest Value of <em>k</em></h4>

<p>For the modified algorithm to have the same asymptotic running time as standard merge sort, \(\Theta(nk + n \lg(n/k))\) must be same as \(\Theta(n \lg n)\).</p>

<p>To satisfy this condition, \(k\) cannot grow faster than \(\lg n\) asymptotically, if it does then because of the \(nk\) term, the algorithm will run at worse asymptotic time than \(\Theta(n \lg n)\)).</p>

<p>So, let’s assume, \(k = \Theta(\lg n)\) and see if we can meet the criteria …</p>

\[\begin {aligned}
\Theta(nk + n \lg(n/k)) &amp; = \Theta(nk + n \lg n - n \lg k) \\
                        &amp; = \Theta(n \lg n + n \lg n - n \lg (\lg n)) \\
                        &amp; = \Theta(2n \lg n - n \lg (\lg n)) ^\dagger \\
                        &amp; = \Theta(n \lg n)
\end {aligned}\]

<p>\(^\dagger\lg (\lg n)\) is very small compared to \(\lg n\) for sufficiently larger values of \(n\).</p>

<h4 id="practical-value-of-k">Practical Value of <em>k</em></h4>

<p>To determine a practical value for \(k\), it has to be the largest input size for which insertion sort runs faster  than merge sort. To get exact value, we need to calculate the exact running time expressions with the constant factors and use the method described in <a href="/CLRS/01/E01.02-02/">Exercise 1.2.2</a>.</p>

    </div>
    <hr class="solid"/>
    <div class="article-footer">
        <div class="article-footer-message">
    <span style="font-size: 0.8em;">If you have any question or suggestion or you have found any error in this solution, please leave a comment below.</span>
</div>
        <div class="article-nav">
    <div class="article-nav-left">
        
            <a href="/CLRS/02/E02.03-07/">
                <i class="fa fa-2x fa-arrow-left"></i>
            </a>
            <span><strong>E 2.3-7</strong></span>
        
    </div>
    <div class="article-nav-middle">
        <a href="/CLRS/">
            <strong>Solution Index</strong>
        </a>
    </div>
    <div class="article-nav-right">
        
            <span><strong>P 2-2</strong></span>
            <a href="/CLRS/02/P02-02/">
                <i class="fa fa-2x fa-arrow-right"></i>
            </a>
        
    </div>
</div>



<script>
     function showSupportMessage() {
          var placeholders = document.getElementsByClassName("support-message");
          console.log(placeholders);
          for (var i = 0; i < placeholders.length; i++) {
               placeholders[i].style.display = "block";
          }
     }
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" onerror="showSupportMessage();"></script>

<!-- Display_Horizontal -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-7476503486911097"
     data-ad-slot="5416910574"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<aside class="support-message">
     <header>Looks like you hate ads as much as I do!</header>
     <section>
     <p>And there is nothing wrong with that! However, the ads on this website are unobtrusive and used as section divider. It'd be great if you can whitelist this website from your adblocker and give it a try. If you don't like the experience, you can always turn it back on.</p>
     
     <p>Either way try to leave a message in the <a href="#disqus_thread">comments section</a> to show some support.</p>
     </section>
</aside>

    </div>
</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_observer = new IntersectionObserver(function (entries) {
        // comments section reached
        // start loading Disqus now
        if (entries[0].isIntersecting) {
            var disqus_shortname = 'atekihcan';
            var disqus_identifier = '/CLRS/02/P02-01/';
            var disqus_title = 'Problem 2-1';
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();

            // once executed, stop observing
            disqus_observer.disconnect();
        }
    }, {threshold: [0]});
    disqus_observer.observe(document.querySelector("#disqus_thread"));
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
        </main>
        <footer class="site-footer">
    <div>
        &copy; Atekihcan 2007 - 2023
    </div>
</footer>

<script>
    // Left align KaTeX for pseudo codes
    document.addEventListener("DOMContentLoaded", function() { 
        var docs = document.querySelectorAll('.latex-pseudo-code > span > span');
        for (var i = 0; i < docs.length; i++) {
            docs[i].classList.add('fleqn');
        }
    });
</script>

    </body>
</html>