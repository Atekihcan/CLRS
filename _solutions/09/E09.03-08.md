---
title:       Exercise 9.3-8
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "median, sorted arrays, binary search, logarithmic time"
description: "Let X[1..n] and Y[1..n] be two arrays, each containing n numbers already in sorted order. Give an O(lg n)-time algorithm to find the median of all 2n elements in arrays X and Y."
---

> Let $$X[1 \ldots n]$$ and $$Y[1 \ldots n]$$ be two arrays, each containing $$n$$ numbers already in sorted order. Give an $$O(\lg n)$$-time algorithm to find the median of all $$2n$$ elements in arrays $$X$$ and $$Y$$.

The median of $$2n$$ elements is the $$n$$th smallest element (using lower median convention). We can use binary search to efficiently locate this element by comparing medians of subarrays.

The key insight is that if we compare the medians of $$X$$ and $$Y$$, we can eliminate half of one array from consideration. Specifically, if the median of $$X$$ is less than the median of $$Y$$, then the overall median cannot be in the lower half of $$X$$ (those elements are too small) or the upper half of $$Y$$ (those elements are too large).

{% capture code %}
Median-Two-Sorted-Arrays(X, Y, p, q, n)
    // p, q are starting indices, n is current length
    if n == 1
        return min(X[p], Y[q])
    if n == 2
        return max(min(X[p], Y[q]), min(X[p+1], Y[q+1]))

    m1 = median of X[p..p+n-1]  // X[p + ⌊n/2⌋]
    m2 = median of Y[q..q+n-1]  // Y[q + ⌊n/2⌋]

    if m1 == m2
        return m1
    if m1 < m2
        // Median is in upper half of X or lower half of Y
        if n is even
            return Median-Two-Sorted-Arrays(X, Y, p + n/2, q, n/2)
        else
            return Median-Two-Sorted-Arrays(X, Y, p + n/2, q, n/2 + 1)
    else  // m1 > m2
        // Median is in lower half of X or upper half of Y
        if n is even
            return Median-Two-Sorted-Arrays(X, Y, p, q + n/2, n/2)
        else
            return Median-Two-Sorted-Arrays(X, Y, p, q + n/2, n/2 + 1)
{% endcapture %}
{% include clrs_code.html %}

Initially call $$\textsc{Median-Two-Sorted-Arrays}(X, Y, 1, 1, n)$$.

{% include ads.html %}

**Why this works:**

When $$m_1 < m_2$$, consider the elements smaller than $$m_1$$ in $$X$$ (roughly $$n/2$$ elements). All these elements are also smaller than $$m_2$$, and there are approximately $$n/2$$ elements in $$Y$$ that are smaller than $$m_2$$. So there are at least $$n$$ elements total that are greater than or equal to all elements in the lower half of $$X$$. Therefore, the overall median (the $$n$$th smallest) cannot be in the lower half of $$X$$.

By symmetric reasoning, the overall median cannot be in the upper half of $$Y$$ (those elements are too large). We eliminate approximately $$n/2$$ elements from each array, leaving $$n$$ elements total to search.

**Analysis:**

The recurrence is $$T(n) = T(n/2) + O(1)$$, which solves to $$T(n) = O(\lg n)$$.

**Example:** $$X = [1, 3, 5, 7, 9]$$, $$Y = [2, 4, 6, 8, 10]$$. Median of $$X$$ is 5, median of $$Y$$ is 6. Since $$5 < 6$$, eliminate $$[1, 3]$$ from $$X$$ and $$[8, 10]$$ from $$Y$$. Recursively find median of $$X' = [5, 7, 9]$$ and $$Y' = [2, 4, 6]$$, which is 5.