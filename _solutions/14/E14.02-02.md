---
title:       Exercise 14.2-2
published:   2025-11-16 00:00
modified:    2025-11-16 00:00
keywords:    "red-black tree, black-height, depth, augmentation, Theorem 14.1"
description: "Can we maintain the black-heights of nodes in a red-black tree as attributes in the nodes of the tree without affecting the asymptotic performance of any of the red-black tree operations? Show how, or argue why not. How about maintaining the depths of nodes?"
---

> Can we maintain the black-heights of nodes in a red-black tree as attributes in the nodes of the tree without affecting the asymptotic performance of any of the red-black tree operations? Show how, or argue why not. How about maintaining the depths of nodes?

This exercise asks us to determine whether two different attributes can be efficiently maintained in a red-black tree using the framework of Theorem 14.1.

### Black-Heights

Yes, we can maintain black-heights efficiently. The black-height $$bh(x)$$ of a node $$x$$ is the number of black nodes on any path from $$x$$ to a leaf (not counting $$x$$ itself).

The key property is that $$bh(x)$$ depends only on local information:

$$bh(x) = \begin{cases}
bh(x.left) & \text{if } x.left \text{ is black} \\
bh(x.left) - 1 & \text{if } x.left \text{ is red}
\end{cases}$$

Since the black-height of the left and right children must be equal (by the red-black tree properties), we can use either child. We can rewrite this more simply:

$$bh(x) = bh(x.left) + \begin{cases}
1 & \text{if } x.left.color = \text{BLACK} \\
0 & \text{if } x.left.color = \text{RED}
\end{cases}$$

This satisfies the condition of Theorem 14.1: $$bh(x)$$ depends only on the information in $$x$$, $$x.left$$, and $$x.right$$ (specifically, $$x.left.bh$$ and $$x.left.color$$). Therefore, by Theorem 14.1, we can maintain black-heights during insertion and deletion in $$O(\lg n)$$ time without affecting the asymptotic performance.

During a rotation, only two nodes change their children, so we can update their black-heights in $$O(1)$$ time. During color changes in the fixup procedures, we may need to update black-heights along the path to the root, but this is $$O(\lg n)$$ time, which doesn't affect the overall complexity.

{% include ads.html %}

### Depths

No, we cannot efficiently maintain node depths using Theorem 14.1. The depth $$depth(x)$$ of a node $$x$$ is the number of edges from the root to $$x$$.

The depth does not satisfy Theorem 14.1's requirement because $$depth(x)$$ does not depend only on local information ($$x$$, $$x.left$$, and $$x.right$$). Instead, $$depth(x) = depth(x.p) + 1$$, so it depends on the depth of the parent, which depends on the grandparent, and so on, all the way to the root.

Consider what happens during a rotation. A rotation at node $$x$$ changes the depth of all nodes in one of $$x$$'s subtrees. Specifically, if we left-rotate at $$x$$, all nodes in $$x$$'s left subtree increase their depth by 1, while all nodes in the right subtree of $$x$$'s right child decrease their depth by 1. This could require updating $$\Theta(n)$$ nodes for a single rotation.

Since red-black tree insertion and deletion can perform rotations, and updating depths after a rotation could take $$\Theta(n)$$ time, maintaining depth attributes would degrade the insertion and deletion operations from $$O(\lg n)$$ to $$O(n)$$ in the worst case.

Therefore, while we can maintain depths, doing so would affect the asymptotic performance of red-black tree operations.
