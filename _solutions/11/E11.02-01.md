---
title:       Exercise 11.2-1
published:   2025-11-16 12:00
modified:    2025-11-16 12:00
keywords:    "hash function, collisions, expected value, simple uniform hashing"
description: "Suppose we use a hash function h to hash n distinct keys into an array T of length m. Assuming simple uniform hashing, what is the expected number of collisions? More precisely, what is the expected cardinality of {{k, l} : k â‰  l and h(k) = h(l)}?"
---

> Suppose we use a hash function $$h$$ to hash $$n$$ distinct keys into an array $$T$$ of length $$m$$. Assuming simple uniform hashing, what is the expected number of collisions? More precisely, what is the expected cardinality of $$\{\{k, l\} : k \neq l \text{ and } h(k) = h(l)\}$$?

A collision occurs when two distinct keys $$k$$ and $$l$$ hash to the same slot, meaning $$h(k) = h(l)$$. We want to count the expected number of such pairs.

The set $$\{\{k, l\} : k \neq l \text{ and } h(k) = h(l)\}$$ contains unordered pairs of distinct keys that collide. Under simple uniform hashing, each key is equally likely to hash to any of the $$m$$ slots independently.

For any specific pair of distinct keys $$k$$ and $$l$$, the probability they collide is:

$$\Pr\{h(k) = h(l)\} = \frac{1}{m}$$

This is because $$k$$ hashes to some slot with probability 1, and then $$l$$ independently hashes to that same slot with probability $$1/m$$.

The total number of distinct pairs of keys is $$\binom{n}{2} = \frac{n(n-1)}{2}$$. Let $$X_{kl}$$ be an indicator random variable that equals 1 if keys $$k$$ and $$l$$ collide, and 0 otherwise. Then the total number of colliding pairs is:

$$X = \sum_{k < l} X_{kl}$$

By linearity of expectation:

$$\begin{align*}
\mathbb{E}[X] &= \mathbb{E}\left[\sum_{k < l} X_{kl}\right] \\
&= \sum_{k < l} \mathbb{E}[X_{kl}] \\
&= \sum_{k < l} \Pr\{h(k) = h(l)\} \\
&= \binom{n}{2} \cdot \frac{1}{m} \\
&= \frac{n(n-1)}{2m}
\end{align*}$$

Therefore, the expected number of collisions is $$\frac{n(n-1)}{2m}$$.

When $$n = m$$ (load factor $$\alpha = 1$$), we expect about $$\frac{m(m-1)}{2m} \approx \frac{m}{2}$$ collisions. When $$n = \sqrt{m}$$, we expect about $$\frac{m \cdot (m-1)}{2m} \approx \frac{1}{2}$$ collision. This connects to the birthday paradox: with $$n = \Theta(\sqrt{m})$$ keys, we expect a constant number of collisions.

{% capture note %}
**Connection to Birthday Paradox**

This analysis is closely related to the birthday paradox discussed in Section 5.4.1. The birthday paradox asks: how many people do you need before two likely share a birthday? The answer is about $$\sqrt{365} \approx 23$$ people.

Here, we're asking how many collisions to expect when hashing $$n$$ keys into $$m$$ slots. When $$n \approx \sqrt{m}$$, we start seeing $$\Theta(1)$$ collisions on average. When $$n = m$$, we expect $$\Theta(m)$$ collisions.
{% endcapture %}
{% include aside.html title='Birthday Paradox Connection' %}
