---
title:       Problem 8-6
published:   2025-11-16 20:15
modified:    2025-11-16 20:15
keywords:    "merging, sorted lists, lower bound, decision tree, comparisons"
description: "Lower bound on merging sorted lists"
---

> **Lower bound on merging sorted lists**
>
> The problem of merging two sorted lists arises frequently. We have seen a procedure for it as the subroutine $$\textsc{Merge}$$ in Section 2.3.1. In this problem, we will prove a lower bound of $$2n - 1$$ on the worst-case number of comparisons required to merge two sorted lists, each containing $$n$$ items.
>
> First we will show a lower bound of $$2n - o(n)$$ comparisons by using a decision tree.
>
> 1. Given $$2n$$ numbers, compute the number of possible ways to divide them into two sorted lists, each with $$n$$ numbers.
> 2. Using a decision tree and your answer to part (a), show that any algorithm that correctly merges two sorted lists must perform at least $$2n - o(n)$$ comparisons.
>
> Now we will show a slightly tighter $$2n - 1$$ bound.
>
> 3. Show that if two elements are consecutive in the sorted order and from different lists, then they must be compared.
> 4. Use your answer to the previous part to show a lower bound of $$2n - 1$$ comparisons for merging two sorted lists.

### A. Number of ways to divide $$2n$$ numbers into two sorted lists

Think about this combinatorially. We have $$2n$$ distinct numbers, and we need to choose which $$n$$ go into the first list (the other $$n$$ automatically go into the second list). Once we've decided which numbers go into each list, their order within each list is determined since each list must be sorted.

The number of ways to choose $$n$$ items from $$2n$$ items is:

$$\binom{2n}{n} = \frac{(2n)!}{n! \cdot n!}$$

Using Stirling's approximation or the fact that $$\binom{2n}{n} \approx \frac{4^n}{\sqrt{\pi n}}$$:

$$\lg \binom{2n}{n} = \Theta(n)$$

More precisely, $$\lg \binom{2n}{n} = 2n - O(\lg n) = 2n - o(n)$$.

### B. Lower bound of $$2n - o(n)$$ using decision tree

Any algorithm that merges two sorted lists must distinguish between all $$\binom{2n}{n}$$ possible ways the elements could be divided into the two lists.

Using the decision tree model:
- The decision tree must have at least $$\binom{2n}{n}$$ leaves
- A binary tree of height $$h$$ has at most $$2^h$$ leaves
- Therefore, $$2^h \geq \binom{2n}{n}$$

Taking logarithms:

$$h \geq \lg \binom{2n}{n} = 2n - o(n)$$

Thus, any algorithm must make at least $$2n - o(n)$$ comparisons in the worst case.

{% include ads.html %}

### C. Consecutive elements from different lists must be compared

Let $$x$$ and $$y$$ be two elements that are consecutive in the final sorted order (meaning no element lies between them in value). Suppose $$x$$ comes from list $$A$$ and $$y$$ comes from list $$B$$, with $$x < y$$.

We must prove that any correct merging algorithm must compare $$x$$ and $$y$$.

**Proof by contradiction:** Suppose an algorithm correctly merges the lists without ever comparing $$x$$ and $$y$$.

Since $$x$$ and $$y$$ are never compared, the algorithm's behavior must be the same whether $$x < y$$ or $$y < x$$.

Consider two scenarios:
1. **Original input:** Lists where $$x < y$$ (and they're consecutive)
2. **Modified input:** Swap the values of $$x$$ and $$y$$, so now $$y < x$$ but they're still from different lists

In the modified input, $$y$$ and $$x$$ are still consecutive (no elements between them), but their order is reversed.

Since the algorithm never compares $$x$$ and $$y$$, it follows the same sequence of comparisons for both inputs. Therefore, it produces the same output for both inputs. But the correct output should place $$x$$ before $$y$$ in the original input and $$y$$ before $$x$$ in the modified input. This is a contradiction.

Therefore, $$x$$ and $$y$$ must be compared.

### D. Lower bound of $$2n - 1$$ comparisons

Consider the final merged sorted list of $$2n$$ elements. There are $$2n - 1$$ consecutive pairs of elements.

From part (c), every consecutive pair where elements come from different lists must be compared.

In the worst case, how many consecutive pairs have elements from different lists?

The worst case is when elements from the two lists alternate as much as possible in the final sorted order. For example:
- List A: $$[1, 3, 5, 7]$$
- List B: $$[2, 4, 6, 8]$$
- Merged: $$[1, 2, 3, 4, 5, 6, 7, 8]$$

In this example, all $$2n - 1$$ consecutive pairs involve elements from different lists. This represents the worst case for the merging algorithm.

The key insight is that the worst-case input occurs when elements from the two lists interleave maximally in the sorted output. In such cases, all $$2n - 1$$ consecutive pairs in the merged list involve elements from different lists, and therefore all must be compared (by part c).

Since there exists an input requiring $$2n - 1$$ comparisons, the lower bound on the worst-case number of comparisons is $$\Omega(2n - 1) = \Omega(n)$$.
