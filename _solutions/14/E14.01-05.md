---
title:       Exercise 14.1-5
published:   2025-11-16 00:00
modified:    2025-11-16 00:00
keywords:    "order-statistic tree, successor, tree operations, logarithmic time"
description: "Given an element x in an n-node order-statistic tree and a natural number i, how can we determine the ith successor of x in the linear order of the tree in O(lg n) time?"
---

> Given an element $$x$$ in an $$n$$-node order-statistic tree and a natural number $$i$$, how can we determine the $$i$$th successor of $$x$$ in the linear order of the tree in $$O(\lg n)$$ time?

Finding the $$i$$th successor of node $$x$$ means finding the element that is $$i$$ positions after $$x$$ in an inorder traversal of the tree. We can solve this efficiently by combining the rank operation with selection.

The algorithm consists of two steps. First, compute the rank of $$x$$ using $$\textsc{OS-Rank}(T, x)$$. This gives us the position of $$x$$ in the sorted order. Second, select the element at position $$\text{rank}(x) + i$$ using $$\textsc{OS-Select}(T.root, \text{rank}(x) + i)$$.

Here's the complete procedure:

{% capture code %}
OS-ith-Successor(T, x, i)
    r = OS-Rank(T, x)
    if r + i > T.root.size
        return T.nil  // not enough elements after x
    return OS-Select(T.root, r + i)
{% endcapture %}
{% include clrs_code.html title="OS-ith-Successor(T, x, i)" %}

The algorithm first computes the rank $$r$$ of node $$x$$ (line 1), which takes $$O(\lg n)$$ time. We then check if the requested successor exists (line 2). If $$r + i$$ exceeds the total number of nodes in the tree, there is no $$i$$th successor, so we return $$T.nil$$. Otherwise, we use $$\textsc{OS-Select}$$ to find the element at position $$r + i$$ (line 4), which also takes $$O(\lg n)$$ time.

Since both operations take $$O(\lg n)$$ time, the total running time is $$O(\lg n) + O(\lg n) = O(\lg n)$$.

For example, if $$x$$ has rank 10 and we want the 3rd successor, we compute $$\textsc{OS-Select}(T.root, 13)$$ to find the element at position 13, which is exactly 3 positions after the element at position 10.
