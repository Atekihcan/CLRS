---
title:       Exercise 7.4-1
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "quicksort, recurrence, omega bound, worst-case analysis"
description: "Show that in the recurrence T(n) = max₀≤q≤n₋₁(T(q) + T(n-q-1)) + Θ(n), T(n) = Ω(n²)."
---

> Show that in the recurrence

> $$T(n) = \max_{0 \leq q \leq n-1} (T(q) + T(n-q-1)) + \Theta(n)$$,

> $$T(n) = \Omega(n^2)$$.

We'll use the substitution method to prove the lower bound $$T(n) = \Omega(n^2)$$. This requires showing that $$T(n) \geq cn^2$$ for some constant $$c > 0$$ and sufficiently large $$n$$.

The recurrence represents quicksort's worst-case running time, where we take the maximum over all possible partition outcomes. To find a lower bound, we need to show that even the best choice of $$q$$ (which would give us the minimum value) still yields $$\Omega(n^2)$$.

However, for the lower bound, we can choose a specific value of $$q$$ that we know will occur in some execution. The worst case occurs when $$q = 0$$ or $$q = n-1$$ (maximally unbalanced partitions). Let's use $$q = 0$$:

$$T(n) \geq T(0) + T(n-1) + cn$$

where we've replaced $$\Theta(n)$$ with $$cn$$ for some constant $$c > 0$$.

Since $$T(0) = \Theta(1)$$, we can write:

$$T(n) \geq T(n-1) + cn$$

**Hypothesis:** $$T(n) \geq dn^2$$ for some constant $$d > 0$$.

**Base case:** For small $$n$$, we can choose $$d$$ small enough that $$T(n) \geq dn^2$$ holds.

**Inductive step:** Assume $$T(k) \geq dk^2$$ for all $$k < n$$. We need to show $$T(n) \geq dn^2$$.

$$\begin{align*}
T(n) &\geq T(n-1) + cn \\
     &\geq d(n-1)^2 + cn \\
     &= d(n^2 - 2n + 1) + cn \\
     &= dn^2 - 2dn + d + cn \\
     &= dn^2 + (c - 2d)n + d
\end{align*}$$

For this to be at least $$dn^2$$, we need:

$$(c - 2d)n + d \geq 0$$

Choosing $$d \leq c/3$$ ensures this inequality holds for all $$n \geq 1$$:

$$(c - 2 \cdot c/3)n + c/3 = \frac{cn}{3} + \frac{c}{3} = \frac{c(n+1)}{3} > 0$$

Therefore, $$T(n) \geq dn^2$$ for $$d = c/3$$, which proves $$T(n) = \Omega(n^2)$$.

From Section 7.4.1, we know $$T(n) = O(n^2)$$. Combined with our lower bound $$T(n) = \Omega(n^2)$$, we conclude:

$$T(n) = \Theta(n^2)$$

This confirms that quicksort's worst-case running time is quadratic, which occurs when the input is already sorted (or reverse sorted) and we always pick the last element as the pivot.

{% capture note %}
The key to this proof is recognizing that the max in the recurrence allows us to choose the worst $$q$$ value for establishing a lower bound. We don't need to consider all possible $$q$$ values; showing that one particular choice ($$q = 0$$) leads to $$\Omega(n^2)$$ is sufficient to establish the lower bound on the maximum.
{% endcapture %}
{% include aside.html title='Lower bounds and worst cases' %}
