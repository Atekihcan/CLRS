---
title:       Problem 9-2
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "weighted median, order statistics, post-office location, Manhattan distance, optimization"
description: "For n distinct elements x₁, x₂, ..., xₙ with positive weights w₁, w₂, ..., wₙ such that the sum of weights equals 1, the weighted (lower) median is the element xₖ satisfying certain weight conditions."
---

> **Weighted median**
>
> For $$n$$ distinct elements $$x_1, x_2, \ldots, x_n$$ with positive weights $$w_1, w_2, \ldots, w_n$$ such that $$\sum_{i=1}^{n} w_i = 1$$, the **weighted (lower) median** is the element $$x_k$$ satisfying
>
> $$\sum_{x_i < x_k} w_i < \frac{1}{2}$$
>
> and
>
> $$\sum_{x_i > x_k} w_i \le \frac{1}{2}$$.
>
> For example, if the elements are $$0.1, 0.35, 0.05, 0.1, 0.15, 0.05, 0.2$$ and each element equals its weight (that is, $$w_i = x_i$$ for $$i = 1, 2, \ldots, 7$$), then the median is $$0.1$$, but the weighted median is $$0.2$$.
>
> 1. Argue that the median of $$x_1, x_2, \ldots, x_n$$ is the weighted median of the $$x_i$$ with weights $$w_i = 1/n$$ for $$i = 1, 2, \ldots, n$$.
> 2. Show how to compute the weighted median of $$n$$ elements in $$O(n \lg n)$$ worst-case time using sorting.
> 3. Show how to compute the weighted median in $$\Theta(n)$$ worst-case time using a linear-time median algorithm such as $$\textsc{Select}$$ from Section 9.3.
>
> The **post-office location problem** is defined as follows. We are given $$n$$ points $$p_1, p_2, \ldots, p_n$$ with associated weights $$w_1, w_2, \ldots, w_n$$. We wish to find a point $$p$$ (not necessarily one of the input points) that minimizes the sum $$\sum_{i=1}^{n} w_i d(p, p_i)$$, where $$d(a, b)$$ is the distance between points $$a$$ and $$b$$.
>
> 4. Argue that the weighted median is a best solution for the 1-dimensional post-office location problem, in which points are simply real numbers and the distance between points $$a$$ and $$b$$ is $$d(a, b) = |a - b|$$.
> 5. Find the best solution for the 2-dimensional post-office location problem, in which the points are $$(x, y)$$ coordinate pairs and the distance between points $$a = (x_1, y_1)$$ and $$b = (x_2, y_2)$$ is the Manhattan distance given by $$d(a, b) = |x_1 - x_2| + |y_1 - y_2|$$.

### A.

With uniform weights $$w_i = 1/n$$, the weighted median conditions become:

$$\sum_{x_i < x_k} \frac{1}{n} < \frac{1}{2} \quad \text{and} \quad \sum_{x_i > x_k} \frac{1}{n} \le \frac{1}{2}$$

This simplifies to:

$$\frac{|\{x_i : x_i < x_k\}|}{n} < \frac{1}{2} \quad \text{and} \quad \frac{|\{x_i : x_i > x_k\}|}{n} \le \frac{1}{2}$$

The first condition says fewer than $$n/2$$ elements are smaller than $$x_k$$, and the second says at most $$n/2$$ elements are larger. For the lower median (at position $$\lfloor (n+1)/2 \rfloor$$ in sorted order), exactly $$\lfloor (n+1)/2 \rfloor - 1 < n/2$$ elements are smaller, and $$n - \lfloor (n+1)/2 \rfloor \le n/2$$ elements are larger. Therefore, the traditional median is the weighted median with uniform weights.

### B.

Sort the elements in $$O(n \lg n)$$ time. Let the sorted order be $$x_{i_1} \le x_{i_2} \le \cdots \le x_{i_n}$$ with corresponding weights $$w_{i_1}, w_{i_2}, \ldots, w_{i_n}$$.

Compute cumulative weights: $$S_j = \sum_{k=1}^{j} w_{i_k}$$ for $$j = 1, 2, \ldots, n$$. Find the smallest index $$j$$ such that $$S_j \ge 1/2$$. The element $$x_{i_j}$$ is the weighted median.

**Verification:** Since $$S_{j-1} < 1/2$$ and $$S_j \ge 1/2$$, the sum of weights below $$x_{i_j}$$ is $$S_{j-1} < 1/2$$, and the sum above is $$1 - S_j \le 1/2$$. This satisfies the weighted median conditions.

**Time:** Sorting takes $$O(n \lg n)$$, cumulative sum computation takes $$O(n)$$, and finding $$j$$ takes $$O(n)$$.

**Total time:** $$O(n \lg n)$$

### C.

Use $$\textsc{Select}$$ to find the median $$m$$ of the $$x_i$$ values in $$O(n)$$ time. Partition the elements around $$m$$ in $$O(n)$$ time into three sets: $$L = \{x_i : x_i < m\}$$, $$E = \{x_i : x_i = m\}$$, and $$R = \{x_i : x_i > m\}$$.

Compute $$W_L = \sum_{x_i \in L} w_i$$ and $$W_R = \sum_{x_i \in R} w_i$$ in $$O(n)$$ time.

**Case 1:** If $$W_L < 1/2$$ and $$W_R \le 1/2$$, then $$m$$ is the weighted median.

**Case 2:** If $$W_L \ge 1/2$$, the weighted median is in $$L$$. Create a new element $$m'$$ with weight $$w_{m'} = w_m + W_R$$ where $$w_m$$ is the total weight of elements equal to $$m$$. Recursively find the weighted median in $$L \cup \{m'\}$$.

**Case 3:** If $$W_R > 1/2$$, the weighted median is in $$R$$. Create a new element $$m'$$ with weight $$w_{m'} = w_m + W_L$$. Recursively find the weighted median in $$R \cup \{m'\}$$.

The recurrence is $$T(n) = T(n/2) + O(n) = O(n)$$ by the Master Theorem.

{% include ads.html %}

### D.

Let $$f(p) = \sum_{i=1}^{n} w_i |p - p_i|$$ be the objective function. For any $$p < p_k$$, moving $$p$$ slightly to the right by $$\epsilon$$ changes the cost by:

$$\Delta f = \sum_{p_i > p} w_i \epsilon - \sum_{p_i < p} w_i \epsilon = \epsilon \left(\sum_{p_i > p} w_i - \sum_{p_i < p} w_i\right)$$

At the weighted median $$p_k$$, we have $$\sum_{p_i < p_k} w_i < 1/2$$ and $$\sum_{p_i > p_k} w_i \le 1/2$$. So:

- For $$p < p_k$$: $$\sum_{p_i > p} w_i > 1/2 > \sum_{p_i < p} w_i$$, so moving right decreases cost
- For $$p > p_k$$: $$\sum_{p_i < p} w_i \ge 1/2 \ge \sum_{p_i > p} w_i$$, so moving left decreases cost

Therefore, $$p_k$$ is a local (and global) minimum. The weighted median minimizes the weighted sum of absolute deviations.

### E.

With Manhattan distance, $$d(p, p_i) = |x - x_i| + |y - y_i|$$, so:

$$\sum_{i=1}^{n} w_i d(p, p_i) = \sum_{i=1}^{n} w_i |x - x_i| + \sum_{i=1}^{n} w_i |y - y_i|$$

This separates into independent 1-dimensional problems. The optimal $$x$$-coordinate is the weighted median of the $$x_i$$ values, and the optimal $$y$$-coordinate is the weighted median of the $$y_i$$ values. Both can be computed in $$O(n)$$ time using the algorithm from part C.

**Solution:** $$p = (x_{\text{wm}}, y_{\text{wm}})$$ where $$x_{\text{wm}}$$ is the weighted median of $$\{x_i\}$$ and $$y_{\text{wm}}$$ is the weighted median of $$\{y_i\}$$.
