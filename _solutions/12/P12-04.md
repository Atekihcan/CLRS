---
title:       Problem 12-4
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "binary trees, Catalan numbers, generating functions, combinatorics"
description: "Let b_n denote the number of different binary trees with n nodes. In this problem, you will find a formula for b_n, as well as an asymptotic estimate."
---

> **Number of different binary trees**
>
> Let $$b_n$$ denote the number of different binary trees with $$n$$ nodes. In this problem, you will find a formula for $$b_n$$, as well as an asymptotic estimate.

### A. Recursive Formula

> Show that $$b_0 = 1$$ and that, for $$n \ge 1$$,
>
> $$b_n = \sum_{k=0}^{n-1} b_k b_{n-1-k}$$

**Base case:** $$b_0 = 1$$

There is exactly one binary tree with 0 nodes: the empty tree ($$\textsc{Nil}$$). So $$b_0 = 1$$ ✓

**Recursive case:** For $$n \ge 1$$, a binary tree has a root, a left subtree with $$k$$ nodes (for some $$0 \le k \le n-1$$), and a right subtree with $$n-1-k$$ nodes.

The number of trees with left subtree size $$k$$ is:
- $$b_k$$ choices for the left subtree structure
- $$b_{n-1-k}$$ choices for the right subtree structure
- Total: $$b_k \cdot b_{n-1-k}$$ trees

Summing over all possible left subtree sizes:

$$b_n = \sum_{k=0}^{n-1} b_k b_{n-1-k}$$

✓

For example:
- $$b_0 = 1$$ (empty tree)
- $$b_1 = b_0 \cdot b_0 = 1 \cdot 1 = 1$$ (single node)
- $$b_2 = b_0 b_1 + b_1 b_0 = 1 \cdot 1 + 1 \cdot 1 = 2$$
- $$b_3 = b_0 b_2 + b_1 b_1 + b_2 b_0 = 1 \cdot 2 + 1 \cdot 1 + 2 \cdot 1 = 5$$

### B. Generating Function

> Referring to Problem 4-4 for the definition of a generating function, let $$B(x)$$ be the generating function
>
> $$B(x) = \sum_{n=0}^{\infty} b_n x^n$$
>
> Show that $$B(x) = xB(x)^2 + 1$$, and hence one way to express $$B(x)$$ in closed form is
>
> $$B(x) = \frac{1}{2x}(1 - \sqrt{1-4x})$$

From part A:

$$b_n = \sum_{k=0}^{n-1} b_k b_{n-1-k}$$

Multiply both sides by $$x^n$$ and sum over $$n \ge 1$$:

$$\sum_{n=1}^{\infty} b_n x^n = \sum_{n=1}^{\infty} x^n \sum_{k=0}^{n-1} b_k b_{n-1-k}$$

The left side is $$B(x) - b_0 = B(x) - 1$$.

For the right side, recognize that $$\sum_{k=0}^{n-1} b_k b_{n-1-k}$$ is the convolution of the sequences $$\{b_n\}$$ with itself. The generating function of a convolution is the product of generating functions:

$$\sum_{n=1}^{\infty} x^n \sum_{k=0}^{n-1} b_k b_{n-1-k} = x \cdot B(x) \cdot B(x) = x B(x)^2$$

Therefore:

$$B(x) - 1 = x B(x)^2$$

$$B(x) = x B(x)^2 + 1$$

✓

To solve for $$B(x)$$, rearrange as a quadratic:

$$x B(x)^2 - B(x) + 1 = 0$$

Using the quadratic formula:

$$B(x) = \frac{1 \pm \sqrt{1 - 4x}}{2x}$$

We need $$B(0) = b_0 = 1$$. Taking the limit as $$x \to 0$$:

For the "$$+$$" solution: $$\lim_{x \to 0} \frac{1 + \sqrt{1-4x}}{2x} = \lim_{x \to 0} \frac{1 + (1 - 2x + O(x^2))}{2x} = \lim_{x \to 0} \frac{2 - 2x + O(x^2)}{2x} = \infty$$

For the "$$-$$" solution: Using L'Hôpital's rule or Taylor expansion:
$$\lim_{x \to 0} \frac{1 - \sqrt{1-4x}}{2x} = \lim_{x \to 0} \frac{1 - (1-2x+O(x^2))}{2x} = \lim_{x \to 0} \frac{2x + O(x^2)}{2x} = 1$$

So we take the "$$-$$" solution:

$$B(x) = \frac{1 - \sqrt{1-4x}}{2x}$$

✓

### C. Closed Formula (Catalan Numbers)

> Show that
>
> $$b_n = \frac{1}{n+1} \binom{2n}{n}$$

We expand $$B(x)$$ using the binomial series for $$(1-4x)^{1/2}$$:

$$(1-4x)^{1/2} = \sum_{k=0}^{\infty} \binom{1/2}{k} (-4x)^k$$

where $$\binom{1/2}{k} = \frac{(1/2)(1/2-1)(1/2-2)\cdots(1/2-k+1)}{k!}$$

For $$k \ge 1$$:
$$\binom{1/2}{k} = \frac{(1/2)(-1/2)(-3/2)\cdots((3-2k)/2)}{k!} = \frac{(-1)^{k-1}}{2^{2k-1}} \cdot \frac{1 \cdot 3 \cdot 5 \cdots (2k-3)}{k!}$$

After algebraic manipulation (using properties of binomial coefficients):

$$1 - \sqrt{1-4x} = \sum_{n=1}^{\infty} \frac{2}{n} \binom{2n-2}{n-1} x^n$$

Therefore:

$$B(x) = \frac{1}{2x}(1 - \sqrt{1-4x}) = \sum_{n=1}^{\infty} \frac{1}{n} \binom{2n-2}{n-1} x^{n-1} = \sum_{n=0}^{\infty} \frac{1}{n+1} \binom{2n}{n} x^n$$

Comparing with $$B(x) = \sum_{n=0}^{\infty} b_n x^n$$:

$$b_n = \frac{1}{n+1} \binom{2n}{n}$$

✓

These are the **Catalan numbers**! The sequence begins: 1, 1, 2, 5, 14, 42, 132, ...

### D. Asymptotic Estimate

> Show that
>
> $$b_n = \frac{4^n}{\sqrt{\pi n^{3/2}}} (1 + O(1/n))$$

Using Stirling's approximation $$n! \sim \sqrt{2\pi n} (n/e)^n$$:

$$\begin{align*}
b_n &= \frac{1}{n+1} \binom{2n}{n} \\
&= \frac{1}{n+1} \cdot \frac{(2n)!}{n! \cdot n!} \\
&\sim \frac{1}{n+1} \cdot \frac{\sqrt{4\pi n} (2n/e)^{2n}}{2\pi n (n/e)^{2n}} \\
&= \frac{1}{n+1} \cdot \frac{\sqrt{4\pi n} \cdot 2^{2n}}{2\pi n} \\
&= \frac{1}{n+1} \cdot \frac{4^n}{\sqrt{\pi n}} \\
&\sim \frac{4^n}{n \sqrt{\pi n}} \quad \text{(as } n \to \infty \text{)} \\
&= \frac{4^n}{\sqrt{\pi} n^{3/2}}
\end{align*}$$

More precisely, with error terms from Stirling's approximation:

$$b_n = \frac{4^n}{\sqrt{\pi n^{3/2}}} (1 + O(1/n))$$

✓

This shows that the number of binary trees grows exponentially ($$4^n$$) but is tempered by a polynomial factor ($$n^{-3/2}$$).

{% capture note %}
**Catalan numbers appear everywhere in combinatorics:**

- Number of binary trees with $$n$$ nodes: $$C_n$$
- Number of ways to parenthesize $$n+1$$ factors: $$C_n$$
- Number of paths from $$(0,0)$$ to $$(n,n)$$ that don't cross the diagonal: $$C_n$$
- Number of ways to triangulate a convex $$(n+2)$$-gon: $$C_n$$

The Catalan numbers $$C_n = \frac{1}{n+1}\binom{2n}{n}$$ are fundamental in counting tree-like structures.
{% endcapture %}
{% include aside.html title='Catalan numbers in combinatorics' %}
