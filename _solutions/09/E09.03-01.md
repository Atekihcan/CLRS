---
title:       Exercise 9.3-1
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "select algorithm, median of medians, group size, worst-case linear time"
description: "In the algorithm SELECT, the input elements are divided into groups of 5. Will the algorithm work in linear time if they are divided into groups of 7? Argue that SELECT does not run in linear time if groups of 3 are used."
---

> In the algorithm $$\textsc{Select}$$, the input elements are divided into groups of 5. Will the algorithm work in linear time if they are divided into groups of 7? Argue that $$\textsc{Select}$$ does not run in linear time if groups of 3 are used.

The key to $$\textsc{Select}$$'s linear time performance is ensuring that the recursive calls are made on subarrays that are a constant fraction smaller than the original array. The group size determines how many elements we can guarantee to eliminate in each partition.

**Groups of 7:**

With groups of 7, at least half of the $$\lceil n/7 \rceil$$ medians are greater than or equal to the median-of-medians $$x$$. Each of these groups contributes at least 4 elements greater than $$x$$ (the median and the 3 elements above it). Excluding the group containing $$x$$ and any incomplete group:

{% include ads.html %}

$$\begin{align*}
\text{Elements} > x &\ge 4\left(\left\lceil \frac{1}{2}\left\lceil \frac{n}{7} \right\rceil \right\rceil - 2\right) \ge \frac{2n}{7} - 8
\end{align*}$$

Similarly, at least $$2n/7 - 8$$ elements are less than $$x$$. So the recursive call is on at most $$n - (2n/7 - 8) = 5n/7 + 8$$ elements. The recurrence is:

$$\begin{align*}
T(n) &\le T(\lceil n/7 \rceil) + T(5n/7 + 8) + O(n)
\end{align*}$$

Since $$1/7 + 5/7 = 6/7 < 1$$, the recursive calls shrink the problem by a constant fraction, and by the substitution method, $$T(n) = O(n)$$. So yes, groups of 7 maintain linear time.

**Groups of 3:**

With groups of 3, each group with median greater than $$x$$ contributes only 2 elements greater than $$x$$ (the median and 1 element above it). So:

$$\begin{align*}
\text{Elements} > x &\ge 2\left(\left\lceil \frac{1}{2}\left\lceil \frac{n}{3} \right\rceil \right\rceil - 2\right) \ge \frac{n}{3} - 4
\end{align*}$$

The recursive call is on at most $$n - (n/3 - 4) = 2n/3 + 4$$ elements. The recurrence is:

$$\begin{align*}
T(n) &\le T(\lceil n/3 \rceil) + T(2n/3 + 4) + O(n)
\end{align*}$$

Since $$1/3 + 2/3 = 1$$, the problem size doesn't shrink by a constant fraction. Using the substitution method with $$T(n) \le cn$$:

$$\begin{align*}
T(n) &\le c\lceil n/3 \rceil + c(2n/3 + 4) + an \\
&\le cn/3 + c + 2cn/3 + 4c + an \\
&= cn + 5c + an
\end{align*}$$

This cannot be bounded by $$cn$$ for any constant $$c$$ (we'd need $$5c + an \le 0$$, which is impossible for $$c > 0$$ and $$a > 0$$). Therefore, $$\textsc{Select}$$ does not run in linear time with groups of 3.