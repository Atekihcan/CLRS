---
title:       Exercise 8.4-5 ⋆
published:   2025-11-16 20:15
modified:    2025-11-16 20:15
keywords:    "bucket sort, probability distribution, CDF, random variables"
description: "A probability distribution function P(x) for a random variable X is defined by P(x) = Pr{X ≤ x}. Give an algorithm that sorts numbers drawn from a continuous probability distribution function P that is computable in O(1) time."
---

> A **probability distribution function** $$P(x)$$ for a random variable $$X$$ is defined by $$P(x) = \Pr\{X \leq x\}$$. Suppose that we draw a list of $$n$$ random variables $$X_1, X_2, \ldots, X_n$$ from a continuous probability distribution function $$P$$ that is computable in $$O(1)$$ time. Give an algorithm that sorts these numbers in linear average-case time.

The cumulative distribution function (CDF) $$P(x)$$ tells us the probability that a random variable is at most $$x$$. The key insight is that if $$X$$ has CDF $$P(x)$$, then $$P(X)$$ is uniformly distributed on $$[0, 1]$$.

This is a fundamental result in probability theory: transforming a random variable by its own CDF produces a uniform distribution. We can exploit this to use bucket sort!

### Algorithm

```python
def sort_with_CDF(X, P, n):
    # Create n buckets
    B = [[] for _ in range(n)]

    # Transform each value using the CDF and distribute to buckets
    for x in X:
        p = P(x)  # O(1) time to compute CDF value
        bucket_index = min(int(n * p), n - 1)
        B[bucket_index].append(x)

    # Sort each bucket using insertion sort
    for i in range(n):
        B[i].sort()  # Sort by original values, not transformed

    # Concatenate buckets in order
    result = []
    for bucket in B:
        result.extend(bucket)

    return result
```

### Why This Works

1. **Transformation preserves order:** If $$x < y$$, then $$P(x) < P(y)$$ (since $$P$$ is monotonically increasing as a CDF)

2. **$$P(X_i)$$ is uniform on $$[0, 1]$$:** This is a standard probability result. Intuitively, $$P(x)$$ represents the "percentile" of $$x$$ in the distribution, and percentiles are uniformly distributed.

3. **Bucket sort works on uniform distribution:** Since $$P(X_i) \in [0, 1]$$ uniformly, using bucket index $$\lfloor n \cdot P(X_i) \rfloor$$ distributes elements uniformly across $$n$$ buckets.

### Analysis

- Computing $$P(x_i)$$ for all $$n$$ elements: $$\Theta(n)$$ time
- Distributing into buckets: $$\Theta(n)$$ time
- Expected elements per bucket: $$\Theta(1)$$
- Sorting all buckets: $$n \times O(1) = O(n)$$ time
- Concatenating: $$\Theta(n)$$ time

Total: $$\Theta(n)$$ average-case time.

### Example

If $$P(x) = x^2$$ for $$x \in [0, 1]$$ (a valid CDF), then values drawn from this distribution cluster near 1. But $$P(X) = X^2$$ is uniform, so bucket sort works well on the transformed values while maintaining the correct ordering.

{% capture note %}
This technique generalizes bucket sort to arbitrary continuous distributions, as long as we can efficiently compute the CDF. It's used in practice for simulation and statistical sampling.
{% endcapture %}
{% include aside.html title='Practical Applications' %}
