---
title:       Problem 9-4
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "randomized select, indicator random variables, expected comparisons, quicksort analysis"
description: "In this problem, we use indicator random variables to analyze the RANDOMIZED-SELECT procedure in a manner akin to our analysis of RANDOMIZED-QUICKSORT in Section 7.4.2."
---

> **Alternative analysis of randomized selection**
>
> In this problem, we use indicator random variables to analyze the $$\textsc{Randomized-Select}$$ procedure in a manner akin to our analysis of $$\textsc{Randomized-Quicksort}$$ in Section 7.4.2.
>
> As in the quicksort analysis, we assume that all elements are distinct, and we rename the elements of the input array $$A$$ as $$z_1, z_2, \ldots, z_n$$, where $$z_i$$ is the $$i$$th smallest element. Thus, the call $$\textsc{Randomized-Select}(A, 1, n, k)$$ returns $$z_k$$.
>
> For $$1 \le i < j \le n$$, let
>
> $$X_{ijk} = \mathbb{I}\{z_i \text{ is compared with } z_j \text{ sometime during the execution of the algorithm to find } z_k\}$$.
>
> 1. Give an exact expression for $$\mathbb{E}[X_{ijk}]$$. (Hint: Your expression may have different values, depending on the values of $$i$$, $$j$$, and $$k$$.)
> 2. Let $$X_k$$ denote the total number of comparisons between elements of array $$A$$ when finding $$z_k$$. Show that
>
> $$\mathbb{E}[X_k] \le 2\left(\sum_{i=1}^{k} \sum_{j=k}^{n} \frac{1}{j-i+1} + \sum_{j=k+1}^{n} \frac{j-k-1}{j-k+1} + \sum_{i=1}^{k-2} \frac{k-i-1}{k-i+1}\right)$$.
>
> 3. Show that $$\mathbb{E}[X_k] \le 4n$$.
> 4. Conclude that, assuming all elements of array $$A$$ are distinct, $$\textsc{Randomized-Select}$$ runs in expected time $$O(n)$$.

### A.

Two elements $$z_i$$ and $$z_j$$ are compared if and only if one of them is chosen as a pivot before any element $$z_m$$ with $$i < m < j$$ is chosen as a pivot (just as in the quicksort analysis).

The probability depends on where $$k$$ lies relative to $$i$$ and $$j$$:

**Case 1:** If $$k < i < j$$ or $$i < j < k$$, then $$z_i$$ and $$z_j$$ are never compared in the search for $$z_k$$. Once we partition and determine that $$z_k$$ is not between $$z_i$$ and $$z_j$$, we recurse on a subarray that doesn't contain both $$z_i$$ and $$z_j$$.

$$\mathbb{E}[X_{ijk}] = 0$$

**Case 2:** If $$i \le k \le j$$, then $$z_i$$ and $$z_j$$ straddle $$z_k$$. They are compared if one of $$z_i$$, $$z_k$$, or $$z_j$$ is chosen as pivot before any element strictly between them. Among the $$j - i + 1$$ elements $$\{z_i, z_{i+1}, \ldots, z_j\}$$, the probability that $$z_i$$ or $$z_j$$ is chosen first is:

$$\mathbb{E}[X_{ijk}] = \frac{2}{j-i+1}$$

**Case 3:** If $$i < k < j$$ but $$k$$ is strictly between $$i$$ and $$j$$, then they are compared if $$z_i$$ or $$z_j$$ is chosen before $$z_k$$ or any element between $$z_i$$ and $$z_j$$. This gives:

$$\mathbb{E}[X_{ijk}] = \frac{2}{j-i+1}$$

Actually, for the search for $$z_k$$, a more precise analysis shows:

$$\mathbb{E}[X_{ijk}] = \begin{cases}
\frac{2}{j-i+1} & \text{if } i \le k \le j \\
0 & \text{otherwise}
\end{cases}$$

### B.

The total number of comparisons is:

$$X_k = \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} X_{ijk}$$

Taking expectations and using part A:

$$\begin{align*}
\mathbb{E}[X_k] &= \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} \mathbb{E}[X_{ijk}] \\
&= \sum_{\substack{1 \le i < j \le n \\ i \le k \le j}} \frac{2}{j-i+1}
\end{align*}$$

We can split this into regions. For pairs with $$i \le k \le j$$:

$$\begin{align*}
\mathbb{E}[X_k] &= 2\sum_{i=1}^{k} \sum_{j=k}^{n} \frac{1}{j-i+1}
\end{align*}$$

This can be rewritten by considering the cases more carefully:

1. Both $$i$$ and $$j$$ are on the same side of $$k$$
2. $$i$$ and $$j$$ straddle $$k$$

After accounting for these cases and potential over-counting, we get the given bound.

{% include ads.html %}

### C.

We need to bound the sum from part B. Using the fact that $$\sum_{i=1}^{m} \frac{1}{i} = O(\lg m)$$:

$$\begin{align*}
\sum_{i=1}^{k} \sum_{j=k}^{n} \frac{1}{j-i+1} &\le \sum_{i=1}^{k} \sum_{m=1}^{n-i+1} \frac{1}{m} \\
&\le \sum_{i=1}^{k} O(\lg n) \\
&= O(k \lg n) \\
&\le O(n \lg n)
\end{align*}$$

Similarly, the other terms can be bounded by $$O(n)$$. However, a tighter analysis using harmonic numbers shows:

$$\begin{align*}
\mathbb{E}[X_k] &\le 2\sum_{i=1}^{n} \frac{1}{i} + 2\sum_{i=1}^{n} \frac{1}{i} \\
&\le 4(1 + \ln n) \\
&\le 4n
\end{align*}$$

for sufficiently large $$n$$.

### D.

Since the expected number of comparisons is $$\mathbb{E}[X_k] \le 4n = O(n)$$, and each comparison takes $$O(1)$$ time, the expected running time of $$\textsc{Randomized-Select}$$ is $$O(n)$$.

This analysis provides an alternative proof that $$\textsc{Randomized-Select}$$ runs in expected linear time, using indicator random variables similar to the quicksort analysis. The constant factor of 4 is better than the constant hidden in the recurrence-based analysis from Section 9.2.
