---
title:       Problem 8-1
published:   2025-11-16 20:15
modified:    2025-11-16 20:15
keywords:    "probabilistic lower bound, decision tree, comparison sort, external path length, randomized algorithms"
description: "Probabilistic lower bounds on comparison sorting"
---

> **Probabilistic lower bounds on comparison sorting**
>
> In this problem, we prove a probabilistic $$\Omega(n \lg n)$$ lower bound on the running time of any deterministic or randomized comparison sort on $$n$$ distinct input elements. We begin by examining a deterministic comparison sort $$A$$ with decision tree $$T_A$$. We assume that every permutation of $$A$$'s inputs is equally likely.
>
> 1. Suppose that each leaf of $$T_A$$ is labeled with the probability that it is reached given a random input. Prove that exactly $$n!$$ leaves are labeled $$1/n!$$ and that the rest are labeled 0.
> 2. Let $$D(T)$$ denote the external path length of a decision tree $$T$$; that is, $$D(T)$$ is the sum of the depths of all the leaves of $$T$$. Let $$T$$ be a decision tree with $$k > 1$$ leaves, and let $$LT$$ and $$RT$$ be the left and right subtrees of $$T$$. Show that $$D(T) = D(LT) + D(RT) + k$$.
> 3. Let $$d(k)$$ be the minimum value of $$D(T)$$ over all decision trees $$T$$ with $$k > 1$$ leaves. Show that $$d(k) = \min_{1 \leq i \leq k-1} \{d(i) + d(k-i) + k\}$$.
> 4. Prove that for a given value of $$k > 1$$ and $$i$$ in the range $$1 \leq i \leq k-1$$, the function $$i \lg i + (k-i)\lg(k-i)$$ is minimized at $$i = k/2$$. Conclude that $$d(k) = \Omega(k \lg k)$$.
> 5. Prove that $$D(T_A) = \Omega(n! \lg(n!))$$, and conclude that the average-case time to sort $$n$$ elements is $$\Omega(n \lg n)$$.
> 6. Show that for any randomized comparison sort $$B$$, there exists a deterministic comparison sort $$A$$ whose expected number of comparisons is no more than those made by $$B$$.

{% include ads.html %}

### A.

Since every permutation is equally likely and the sort algorithm is correct, exactly one permutation leads to each valid output ordering. A correct sorting algorithm must have $$n!$$ leaves corresponding to the $$n!$$ possible permutations.

Each permutation has probability $$1/n!$$ of being the input. Since each leaf corresponds to exactly one permutation, exactly $$n!$$ leaves are labeled $$1/n!$$. Any additional leaves (unreachable for our input assumptions) are labeled 0.

### B.

Let $$k_{LT}$$ and $$k_{RT}$$ be the number of leaves in $$LT$$ and $$RT$$ respectively. Then $$k = k_{LT} + k_{RT}$$.

Consider a leaf at depth $$d$$ in $$LT$$. Its depth in $$T$$ is $$d + 1$$ (adding the root). Similarly for $$RT$$.

$$\begin{align*}
D(T) &= \sum_{\text{leaves } \ell \text{ in } T} \text{depth}(\ell) \\
     &= \sum_{\ell \text{ in } LT} (\text{depth}_{LT}(\ell) + 1) + \sum_{\ell \text{ in } RT} (\text{depth}_{RT}(\ell) + 1) \\
     &= \left(\sum_{\ell \text{ in } LT} \text{depth}_{LT}(\ell)\right) + k_{LT} + \left(\sum_{\ell \text{ in } RT} \text{depth}_{RT}(\ell)\right) + k_{RT} \\
     &= D(LT) + D(RT) + k
\end{align*}$$

{% include ads.html %}

### C.

To minimize $$D(T)$$, we choose an optimal split of leaves between $$LT$$ and $$RT$$. If $$LT$$ has $$i$$ leaves, then $$RT$$ has $$k - i$$ leaves.

The minimum external path length for $$i$$ leaves is $$d(i)$$, and for $$k-i$$ leaves is $$d(k-i)$$. Using part (b):

$$d(k) = \min_{1 \leq i \leq k-1} \{d(i) + d(k-i) + k\}$$

### D.

Consider the function $$f(i) = i \lg i + (k-i)\lg(k-i)$$ for $$1 \leq i \leq k-1$$.

Taking the derivative:

$$\frac{df}{di} = \lg i + 1 - \lg(k-i) - 1 = \lg i - \lg(k-i) = \lg \frac{i}{k-i}$$

Setting $$\frac{df}{di} = 0$$: $$\lg \frac{i}{k-i} = 0 \implies \frac{i}{k-i} = 1 \implies i = k/2$$

The second derivative is positive, confirming this is a minimum.

Now we prove $$d(k) = \Omega(k \lg k)$$ by induction. Base case $$d(1) = 0$$ holds trivially.

For $$k > 1$$, using the optimal split at $$i = k/2$$:

$$\begin{align*}
d(k) &\leq d(k/2) + d(k/2) + k \\
     &= 2d(k/2) + k
\end{align*}$$

By induction, $$d(k/2) = \Omega((k/2) \lg(k/2))$$, so $$d(k) = \Omega(k \lg k)$$.

### E.

The average depth of a leaf in $$T_A$$, weighted by probability, is:

$$\frac{D(T_A)}{n!}$$

Since each of the $$n!$$ reachable leaves has probability $$1/n!$$, the expected number of comparisons is $$D(T_A)/n!$$.

From part (d), $$D(T_A) \geq d(n!) = \Omega(n! \lg(n!))$$.

Therefore, average-case time is $$\Omega(n! \lg(n!)/n!) = \Omega(\lg(n!)) = \Omega(n \lg n)$$.

### F.

A randomized algorithm $$B$$ can be viewed as a probability distribution over deterministic algorithms. Let $$A_1, A_2, \ldots, A_m$$ be the deterministic algorithms corresponding to the random choices $$B$$ makes, with probabilities $$p_1, p_2, \ldots, p_m$$.

The expected number of comparisons for $$B$$ is:

$$E_B = \sum_{i=1}^{m} p_i \cdot (\text{expected comparisons for } A_i)$$

At least one $$A_j$$ must have expected comparisons $$\leq E_B$$ (by the pigeonhole principle). This deterministic algorithm $$A_j$$ performs no worse than $$B$$ in expectation.
