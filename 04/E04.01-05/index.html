<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- Legacy meta -->
    <meta name="description" content="[Python code] Use the following ideas to develop a non-recursive, linear-time algorithm for the maximum-subarray problem. Start at the left end of the array, and progress toward the right, keeping track of the maximum subarray seen so far."/>
    <meta name="keywords" content="CLRS, solutions, algorithms, Cormen, maximum subarray, python code"/>

    <!--Schema-->
    <link rel="author" href="Atekihcan">
    <link rel="publisher" href="https://atekihcan.github.io">
    <meta itemprop="name" content="CLRS Solutions | Exercise 4.1-5 | Divide-and-Conquer"/>
    <meta itemprop="description" content="[Python code] Use the following ideas to develop a non-recursive, linear-time algorithm for the maximum-subarray problem. Start at the left end of the array, and progress toward the right, keeping track of the maximum subarray seen so far."/>

    <!-- OpenGraph -->
    <meta property="og:title" content="CLRS Solutions | Exercise 4.1-5 | Divide-and-Conquer" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://atekihcan.github.io/CLRS/04/E04.01-05/" />
    <meta property="og:image" content="/CLRS/assets/img/04/4.1-5.jpg" />
    <meta property="og:description" content="[Python code] Use the following ideas to develop a non-recursive, linear-time algorithm for the maximum-subarray problem. Start at the left end of the array, and progress toward the right, keeping track of the maximum subarray seen so far." />

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "CLRS Solutions | Exercise 4.1-5 | Divide-and-Conquer",
        "image": [
            "/CLRS/assets/img/04/4.1-5.jpg"
        ],
        "datePublished": "2012-08-28T18:20:00+00:00",
        "dateModified": "2021-01-19T10:30:00+00:00",
        "author": {
            "@type": "Person",
            "name": "Atekihcan"
        }
    }
    </script>
    
    <title>CLRS Solutions | Exercise 4.1-5 | Divide-and-Conquer</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="/CLRS/assets/img/favicon.png">

    <!-- Normalize reset -->
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/normalize.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Katex -->
    <link rel="stylesheet" href="/CLRS/assets/katex/katex.min.css" >
    <script defer src="/CLRS/assets/katex/katex.min.js" ></script>
    <script defer src="/CLRS/assets/katex/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {trust: true});"></script>

    <!-- Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-57470252-4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-57470252-4', {
            cookie_domain: 'https://atekihcan.github.io',
            cookie_flags: 'SameSite=None;Secure'
        });
    </script>

    <!-- Load site specific stuff at last -->
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/site.css">
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/syntax_highlight.css">

    <script defer src="/CLRS/assets/js/site.js" ></script>
</head>
    <body class="site-body">
        <header class="site-header">
    <nav>
        <i class="fa fa-database"></i>&nbsp;&nbsp;<a href="/CLRS/">Solutions for CLRS</a>&nbsp;&nbsp;<i class="fa fa-database"></i>
    </nav>
    <h1 class="page-title">
        Exercise 4.1-5
    </h1>
</header>
        <main class="site-main">
            <article>
    <div class="article-content">
        <blockquote>
  <p>Use the following ideas to develop a non-recursive, linear-time algorithm for the maximum-subarray problem. Start at the left end of the array, and progress toward the right, keeping track of the maximum subarray seen so far. Knowing a maximum subarray of \(A[1 \dots j]\), extend the answer to find a maximum subarray ending at index \(j + 1\) by using the following observation: a maximum subarray of \(A[1 \dots j + 1]\) is either a maximum subarray of \(A[1 \dots j]\) or a subarray \(A[i \dots j + 1]\), for some \(1 \le i \le j + 1\). Determine a maximum subarray of the form \(A[i \dots j + 1]\) in constant time based on knowing a maximum subarray ending at index \(j\).</p>
</blockquote>

<p>The idea is to determine whether \(A[j + 1]\) will be part of the maximum subarray of \(A[1 \dots j + 1]\) or not. If it is a part of the maximum subarray, then we will update our maximum subarray to include \(A[j + 1]\), otherwise we will maintain a temporary sum including \(A[j + 1]\) in case we encounter a sufficiently large element later which can make the future sum greater than the present sum.</p>

<p>In other words, maintain two sum: a maximum subarray ending at current element, and maximum subarray so far.</p>

<div class="latex-pseudo-code">$$\textsc {Find-Maximum-Subarray-Linear }(A, low, high)$$$$\begin{aligned}1&amp; \quad  best=-∞ \\2&amp; \quad  current=0 \\3&amp; \quad  left=0 \\4&amp; \quad  right=0 \\5&amp; \quad  currentLeft=0 \\6&amp; \quad  \textbf {for }i=low\textbf { to }high \\7&amp; \quad \qquad  current=current+A[i] \\8&amp; \quad \qquad  \textbf {if }current&gt;best \\9&amp; \quad \qquad \qquad  best=current \\10&amp; \quad \qquad \qquad  left=currentLeft \\11&amp; \quad \qquad \qquad  right=i \\12&amp; \quad \qquad  \textbf {if }current&lt;0 \\13&amp; \quad \qquad \qquad  current=0 \\14&amp; \quad \qquad \qquad  currentLeft=i+1 \\15&amp; \quad  \textbf {return }\textsc {}(left,\,right,\,best) \\\end{aligned}$$</div>

<p>In line 7, we update our current sum involving current element. And in lines 8-11, we update our best subarray, if required. In lines 12-14, we reset current running sum if it is negative.</p>

<p>A python implementation of this pseudocode is available at the <a href="#code-editor">bottom of the page</a>.</p>

<aside id="want-to-know-more" class="info">
    <h4>Want to know more </h4>
    <div>
<p>This algorithm is more popularly known as <a href="https://en.wikipedia.org/wiki/Maximum_subarray_problem#Kadane's_algorithm" target="_blank">Kadane’s algorithm</a>. You can find some more discussion on <a href="https://www.geeksforgeeks.org/largest-sum-contiguous-subarray/" target="_blank">GeeksForGeeks</a>.</p>
</div>
</aside>

<script>
     function showSupportMessage() {
          var placeholders = document.getElementsByClassName("support-message");
          console.log(placeholders);
          for (var i = 0; i < placeholders.length; i++) {
               placeholders[i].style.display = "block";
          }
     }
</script>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" onerror="showSupportMessage();"></script>

<!-- Display_Horizontal -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7476503486911097" data-ad-slot="5416910574" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<aside class="support-message">
     <header>Looks like you hate ads as much as I do!</header>
     <section>
     <p>And there is nothing wrong with that! However, the ads on this website are unobtrusive and used as section divider. It'd be great if you can whitelist this website from your adblocker and give it a try. If you don't like the experience, you can always turn it back on.</p>
     
     <p>Either way try to leave a message in the <a href="#disqus_thread">comments section</a> to show some support.</p>
     </section>
</aside>

<h4 id="runtime-comparison">Runtime Comparison</h4>

<p>We can measure the performance of this algorithm along with others as described in <a href="/CLRS/04/E04.01-03/">Exercise 4.1.3</a>. As expected the linear algorithm runs much much faster than other algorithms (running times are in microseconds):</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Size</th>
      <th style="text-align: center">BruteForce</th>
      <th style="text-align: center">Recursive</th>
      <th style="text-align: center">Linear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">20</td>
      <td style="text-align: center">1.1168</td>
      <td style="text-align: center">1.2608</td>
      <td style="text-align: center">0.2176</td>
    </tr>
    <tr>
      <td style="text-align: center">21</td>
      <td style="text-align: center">1.1319</td>
      <td style="text-align: center">1.3312</td>
      <td style="text-align: center">0.2278</td>
    </tr>
    <tr>
      <td style="text-align: center">22</td>
      <td style="text-align: center">1.2343</td>
      <td style="text-align: center">1.3643</td>
      <td style="text-align: center">0.2445</td>
    </tr>
    <tr>
      <td style="text-align: center">23</td>
      <td style="text-align: center">1.3397</td>
      <td style="text-align: center">1.4459</td>
      <td style="text-align: center">0.2512</td>
    </tr>
    <tr>
      <td style="text-align: center">24</td>
      <td style="text-align: center">1.4235</td>
      <td style="text-align: center">1.5344</td>
      <td style="text-align: center">0.2537</td>
    </tr>
    <tr>
      <td style="text-align: center">25</td>
      <td style="text-align: center">1.5350</td>
      <td style="text-align: center">1.6118</td>
      <td style="text-align: center">0.2664</td>
    </tr>
    <tr>
      <td style="text-align: center">26</td>
      <td style="text-align: center">1.6584</td>
      <td style="text-align: center">1.6801</td>
      <td style="text-align: center">0.2766</td>
    </tr>
    <tr>
      <td style="text-align: center">27</td>
      <td style="text-align: center">1.7502</td>
      <td style="text-align: center">1.7495</td>
      <td style="text-align: center">0.2921</td>
    </tr>
    <tr>
      <td style="text-align: center">28</td>
      <td style="text-align: center">1.8662</td>
      <td style="text-align: center">1.8276</td>
      <td style="text-align: center">0.3040</td>
    </tr>
    <tr>
      <td style="text-align: center">29</td>
      <td style="text-align: center">1.9923</td>
      <td style="text-align: center">1.8878</td>
      <td style="text-align: center">0.3043</td>
    </tr>
    <tr>
      <td style="text-align: center">30</td>
      <td style="text-align: center">2.1180</td>
      <td style="text-align: center">1.9716</td>
      <td style="text-align: center">0.3153</td>
    </tr>
    <tr>
      <td style="text-align: center">31</td>
      <td style="text-align: center">2.2915</td>
      <td style="text-align: center">2.0271</td>
      <td style="text-align: center">0.3507</td>
    </tr>
  </tbody>
</table>

<p>The C++ implementation to generate this data can be downloaded from <a href="/CLRS/assets/code/E415.cpp" title="C++ Implementation to Compare Brute Force, Recursive, and Linear Running Times" target="_blank">here</a>.</p>

<p>And here is a visual representation of the runtime comparison.</p>

<p><img src="/CLRS/assets/img/04/4.1-5_maxsubarray_runtime_comparison.jpg" alt="Maximum Subarray Runtime Comparison" title="Maximum Subarray Runtime Comparison" /></p>

<p>As you can see the brute force run time, \(\Theta(n^2)\), very closely resembles a quadratic curve. Runtime of recursive method is \(\Theta(n \lg n)\)  and for linear it is \(\Theta(n)\), the difference between them also can be seen clearly, although both resembles linear curve. That ambiguity will reduce if we can create graph for much higher input size, e.g. \(n = 1000\).</p>

<script>
     function showSupportMessage() {
          var placeholders = document.getElementsByClassName("support-message");
          console.log(placeholders);
          for (var i = 0; i < placeholders.length; i++) {
               placeholders[i].style.display = "block";
          }
     }
</script>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" onerror="showSupportMessage();"></script>

<!-- Display_Horizontal -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7476503486911097" data-ad-slot="5416910574" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<aside class="support-message">
     <header>Looks like you hate ads as much as I do!</header>
     <section>
     <p>And there is nothing wrong with that! However, the ads on this website are unobtrusive and used as section divider. It'd be great if you can whitelist this website from your adblocker and give it a try. If you don't like the experience, you can always turn it back on.</p>
     
     <p>Either way try to leave a message in the <a href="#disqus_thread">comments section</a> to show some support.</p>
     </section>
</aside>

<h4 id="python-implementation">Python Implementation</h4>

<script src="/CLRS/assets/js/skulpt.min.js" type="text/javascript"></script>

<script src="/CLRS/assets/js/skulpt-stdlib.js" type="text/javascript"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.min.js" integrity="sha512-GoORoNnxst42zE3rYPj4bNBm0Q6ZRXKNH2D9nEmNvVF/z24ywVnijAWVi/09iBiVDQVf3UlZHpzhAJIdd9BXqw==" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/mode-python.min.js" integrity="sha512-2Ke4vMGrMfYRM55pT1aA5bw7Pl82Sc7K5Hg8XZYZu+EQrb0AO1mNYTagwZm+MFVAImYS9Mlnm73zcgc01wPXxA==" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/theme-nord_dark.min.js" integrity="sha512-Yrb8fdpeml10Onax7VERUl9ea2bAU/OPQ3IASUNqed9o+EotsVU9L4mgB4jXZQWDjav4VD2HSjiWlwOmfKeJRQ==" crossorigin="anonymous"></script>

<script>
    // Output functions are configurable
    // This one just appends some text to a pre element
    function prependOut(text) {
        var output = document.getElementById("code-editor-output");
        output.innerHTML = output.innerHTML + text;
    }

    function builtinRead(x) {
        if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined) 
            throw "File not found: '" + x + "'";
        return Sk.builtinFiles["files"][x];
    }

    // Grab the code, get a reference to output
    // configure the output function and call Sk.importMainWithBody()
    function runCode() {
        // Get code from Ace editor and clear output
        var prog = (editor.getValue());
        var output = document.getElementById("code-editor-output");
        output.innerHTML = '';

        Sk.pre = "output";
        Sk.configure({output: prependOut, read: builtinRead, __future__: Sk.python3});
        var myPromise = Sk
            .misceval
            .asyncToPromise(function () {
                return Sk.importMainWithBody("<stdin>", false, prog, true);
            });
        myPromise.then(function (mod) {
            output.style.color = "#d8dee9";
            console.log('success');
        }, function (err) {
            output.style.color = "#f00";
            output.innerHTML = err.toString();
            console.log(err.toString());
        });
    }
</script>

<div class="code-editor-wrapper">
    <div id="code-editor">import math

def FindMaxSubarrayLinear(A, low, high):
    best = -math.inf
    current = 0
    left = 0
    right = 0
    current_left = 0
    for i in range(low, high):
        current += A[i]
        if current &gt; best:
            # Update best sum
            best = current
            left = current_left
            right = i
        
        if current &lt; 0:
            # Reset current sum
            current = 0
            current_left = i + 1
    return (left, right, best)

# Test with exact same array as in the example give in book
# Expected answer is A[8..11] = 43

arr = [13, -3, -25, 20, -3, -16, -23, 18, 20, -7, 12, -5, -22, 15, -4, 7]
ans = FindMaxSubarrayLinear(arr, 0, len(arr))

print(f"Max subarray = A[{ans[0] + 1}..{ans[1] + 1}] = {ans[2]}")</div>
    <script>
        var editor = ace.edit("code-editor");
        editor
            .renderer
            .setShowGutter(true);
        editor
            .session
            .setMode("ace/mode/python");
        editor.setTheme("ace/theme/nord_dark");
        editor.setFontSize("16px");
        editor
            .renderer
            .setScrollMargin(15, 15)
        editor.setOptions({autoScrollEditorIntoView: true, minLines: 8, maxLines: 20});
        document.getElementById('code-editor').style.fontFamily = "'Courier New', Courier, monospace";
        var code = editor.getValue();

        function resetCode() {
            editor.setValue(code, 1);
            var output = document.getElementById("code-editor-output");
            output.innerHTML = "";
        }
    </script>
    <pre id="code-editor-output" class="code-editor-output"></pre>
    <div class="code-editor-buttons">
        <button class="code-editor-button" type="button" onclick="runCode()">Run</button>
        <button class="code-editor-button" type="button" onclick="resetCode()">Reset</button>
    </div>
</div>

    </div>
    <hr class="solid"/>
    <div class="article-footer">
        <div class="article-footer-message">
    <span style="font-size: 0.8em;">If you have any question or suggestion or you have found any error in this solution, please leave a comment below.</span>
</div>
        <div class="article-nav">
    <div class="article-nav-left">
        
            <a href="/CLRS/04/E04.01-04/">
                <i class="fa fa-2x fa-arrow-left"></i>
            </a>
            <span><strong>E 4.1-4</strong></span>
        
    </div>
    <div class="article-nav-middle">
        <a href="/CLRS/">
            <strong>Solution Index</strong>
        </a>
    </div>
    <div class="article-nav-right">
        
            <span><strong>E 4.2-1</strong></span>
            <a href="/CLRS/04/E04.02-01/">
                <i class="fa fa-2x fa-arrow-right"></i>
            </a>
        
    </div>
</div>



<script>
     function showSupportMessage() {
          var placeholders = document.getElementsByClassName("support-message");
          console.log(placeholders);
          for (var i = 0; i < placeholders.length; i++) {
               placeholders[i].style.display = "block";
          }
     }
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" onerror="showSupportMessage();"></script>

<!-- Display_Horizontal -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-7476503486911097"
     data-ad-slot="5416910574"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<aside class="support-message">
     <header>Looks like you hate ads as much as I do!</header>
     <section>
     <p>And there is nothing wrong with that! However, the ads on this website are unobtrusive and used as section divider. It'd be great if you can whitelist this website from your adblocker and give it a try. If you don't like the experience, you can always turn it back on.</p>
     
     <p>Either way try to leave a message in the <a href="#disqus_thread">comments section</a> to show some support.</p>
     </section>
</aside>

    </div>
</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_observer = new IntersectionObserver(function (entries) {
        // comments section reached
        // start loading Disqus now
        if (entries[0].isIntersecting) {
            var disqus_shortname = 'atekihcan';
            var disqus_identifier = '/CLRS/04/E04.01-05/';
            var disqus_title = 'Exercise 4.1-5';
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();

            // once executed, stop observing
            disqus_observer.disconnect();
        }
    }, {threshold: [0]});
    disqus_observer.observe(document.querySelector("#disqus_thread"));
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
        </main>
        <footer class="site-footer">
    <div>
        &copy; Atekihcan 2007 - 2023
    </div>
</footer>

<script>
    // Left align KaTeX for pseudo codes
    document.addEventListener("DOMContentLoaded", function() { 
        var docs = document.querySelectorAll('.latex-pseudo-code > span > span');
        for (var i = 0; i < docs.length; i++) {
            docs[i].classList.add('fleqn');
        }
    });
</script>

    </body>
</html>