---
title:       Exercise 14.3-2
published:   2025-11-16 00:00
modified:    2025-11-16 00:00
keywords:    "interval tree, open intervals, overlap, search algorithm"
description: "Rewrite the code for INTERVAL-SEARCH so that it works properly when all intervals are open."
---

> Rewrite the code for $$\textsc{Interval-Search}$$ so that it works properly when all intervals are open.

Open intervals use strict inequalities. Two open intervals $$(t_1, t_2)$$ and $$(t_3, t_4)$$ overlap if and only if their intersection is non-empty, which requires:

$$t_1 < t_3 < t_2 \quad \text{or} \quad t_3 < t_1 < t_4$$

This is equivalent to: $$t_1 < t_4$$ and $$t_3 < t_2$$.

For open intervals, the overlap condition changes from $$i.low \leq i'.high$$ and $$i'.low \leq i.high$$ (for closed intervals) to $$i.low < i'.high$$ and $$i'.low < i.high$$ (for open intervals).

{% capture code %}
Interval-Search-Open(T, i)
    x = T.root
    while x != T.nil and i does not overlap x.int
        if x.left != T.nil and x.left.max > i.low
            x = x.left
        else
            x = x.right
    return x
{% endcapture %}
{% include clrs_code.html title="Interval-Search-Open(T, i)" %}

{% include ads.html %}

The changes from the closed interval version are:

1. **Line 2 overlap check:** For open intervals $$(i.low, i.high)$$ and $$(x.int.low, x.int.high)$$, they overlap if and only if:
   $$i.low < x.int.high \quad \text{and} \quad x.int.low < i.high$$

2. **Line 3 condition:** We go left if $$x.left.max > i.low$$ (strict inequality). This is because $$x.left.max$$ is the maximum high endpoint in the left subtree. For an interval in the left subtree to overlap $$i$$, we need some interval $$(a, b)$$ in the left subtree where $$a < i.high$$ and $$b > i.low$$. Since $$b \leq x.left.max$$, a necessary condition is $$x.left.max > i.low$$.

The correctness proof is similar to Theorem 14.2, with the interval trichotomy modified for open intervals:

For open intervals $$i = (i.low, i.high)$$ and $$i' = (i'.low, i'.high)$$, exactly one of the following holds:
- $$i$$ and $$i'$$ overlap: $$i.low < i'.high$$ and $$i'.low < i.high$$
- $$i$$ is to the left of $$i'$$: $$i.high \leq i'.low$$
- $$i$$ is to the right of $$i'$$: $$i'.high \leq i.low$$

The search algorithm maintains the invariant that if there exists an overlapping interval in the tree, then the subtree rooted at $$x$$ contains such an interval. The proof follows the same structure as in the book, with appropriate modifications for strict inequalities.
