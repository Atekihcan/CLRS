---
title:       Exercise 12.2-6
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "binary search tree, successor, tree structure, proof"
description: "Consider a binary search tree T whose keys are distinct. Show that if the right subtree of a node x in T is empty and x has a successor y, then y is the lowest ancestor of x whose left child is also an ancestor of x. (Recall that every node is its own ancestor.)"
---

> Consider a binary search tree $$T$$ whose keys are distinct. Show that if the right subtree of a node $$x$$ in $$T$$ is empty and $$x$$ has a successor $$y$$, then $$y$$ is the lowest ancestor of $$x$$ whose left child is also an ancestor of $$x$$. (Recall that every node is its own ancestor.)

We need to prove that when $$x.\textit{right} = \textsc{Nil}$$ and $$x$$ has a successor $$y$$, then $$y$$ is characterized by this property: $$y$$ is the lowest ancestor of $$x$$ such that $$y.\textit{left}$$ is also an ancestor of $$x$$ (possibly $$x$$ itself).

### Proof

Since $$x.\textit{right} = \textsc{Nil}$$, the $$\textsc{Tree-Successor}$$ algorithm enters the second case (lines 3-7 in the book's pseudocode), which walks up the tree:

{% capture code %}
y = x.p
while y ≠ NIL and x == y.right
    x = y
    y = y.p
return y
{% endcapture %}
{% include clrs_code.html %}

The algorithm walks up from $$x$$ through ancestors until it finds the first ancestor $$y$$ where the path from $$y$$ went through $$y.\textit{left}$$ (i.e., where $$x$$ is in the left subtree of $$y$$). At that point, $$x \ne y.\textit{right}$$, so the loop terminates and returns $$y$$.

**Why is** $$y$$ **the lowest such ancestor?**

The algorithm starts at $$x$$ and walks upward, checking each ancestor. It stops at the first ancestor $$y$$ where $$x \ne y.\textit{right}$$, meaning $$x$$ is in $$y$$'s left subtree. This is the lowest (closest to $$x$$) ancestor with this property.

**Why is** $$y.\textit{left}$$ **an ancestor of** $$x$$**?**

When the loop terminates, we have $$x \ne y.\textit{right}$$. Since $$x$$ is a descendant of $$y$$ (we reached $$y$$ by walking up from $$x$$), and $$x$$ is not in $$y$$'s right subtree, $$x$$ must be in $$y$$'s left subtree. Therefore, $$x$$ is a descendant of $$y.\textit{left}$$, which means $$y.\textit{left}$$ is an ancestor of $$x$$ (possibly $$x$$ itself, since every node is its own ancestor).

**Why is** $$y$$ **the successor of** $$x$$**?**

By the BST property:
- All nodes in $$y$$'s left subtree (including $$x$$) have keys $$< y.\textit{key}$$
- All ancestors of $$y$$ that we passed through while walking up from $$x$$ had $$x$$ in their right subtree, so their keys are $$< x.\textit{key}$$
- Therefore, $$y.\textit{key}$$ is the smallest key greater than $$x.\textit{key}$$, making $$y$$ the successor of $$x$$

{% include ads.html %}

### Example

Consider this tree:

```
        15
       /  \
      6   18
     / \  / \
    3   7 17 20
   / \   \
  2   4  13
         /
        9
```

Let $$x$$ be node 13 (which has no right child).

Walking up from 13:
- Parent of 13 is 7, and 13 is the right child of 7 (keep going)
- Parent of 7 is 6, and 7 is the right child of 6 (keep going)
- Parent of 6 is 15, and 6 is the left child of 15 (stop!)

So $$y = 15$$ is the successor of 13.

Verification: 15 is the lowest ancestor of 13 such that 15's left child (6) is also an ancestor of 13 ✓

{% capture note %}
This characterization is useful for understanding the structure of BSTs. The successor relationship is intimately tied to the tree structure: finding a successor involves either going right then all the way left, or going up until we've come from a left child.

The symmetric statement holds for predecessors: if $$x.\textit{left} = \textsc{Nil}$$ and $$x$$ has a predecessor $$y$$, then $$y$$ is the lowest ancestor of $$x$$ whose right child is also an ancestor of $$x$$.
{% endcapture %}
{% include aside.html title='Successor characterization' %}
