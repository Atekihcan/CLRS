---
title:       Exercise 14.1-4
published:   2025-11-16 00:00
modified:    2025-11-16 00:00
keywords:    "order-statistic tree, rank search, binary search tree, distinct keys"
description: "Write a recursive procedure OS-KEY-RANK(T, k) that takes as input an order-statistic tree T and a key k and returns the rank of k in the dynamic set represented by T. Assume that the keys of T are distinct."
---

> Write a recursive procedure $$\textsc{OS-Key-Rank}(T, k)$$ that takes as input an order-statistic tree $$T$$ and a key $$k$$ and returns the rank of $$k$$ in the dynamic set represented by $$T$$. Assume that the keys of $$T$$ are distinct.

The procedure $$\textsc{OS-Key-Rank}$$ searches for a key $$k$$ in the tree and computes its rank during the search. The approach combines binary search tree search with rank computation.

{% capture code %}
OS-Key-Rank(T, k)
    return OS-Key-Rank-Helper(T.root, k)

OS-Key-Rank-Helper(x, k)
    if x == T.nil
        return 0  // key not found
    r = x.left.size + 1
    if k == x.key
        return r
    elseif k < x.key
        return OS-Key-Rank-Helper(x.left, k)
    else
        return r + OS-Key-Rank-Helper(x.right, k)
{% endcapture %}
{% include clrs_code.html title="OS-Key-Rank(T, k)" %}

The algorithm works by recursively searching for the key $$k$$ in the tree. At each node $$x$$, we compute $$r = x.left.size + 1$$, which is the rank of $$x$$ within its own subtree.

If $$k$$ equals the current node's key (line 7), we've found the key and return its rank $$r$$ within the current subtree. If $$k$$ is less than the current node's key (line 9), the key must be in the left subtree, so we recursively search there. The rank in the left subtree is the same as the rank in the whole subtree rooted at $$x$$.

If $$k$$ is greater than the current node's key (line 11), the key must be in the right subtree. Here's the key insight: all $$r$$ elements (the left subtree plus $$x$$ itself) come before any element in the right subtree in an inorder walk. Therefore, the rank of $$k$$ in the tree is $$r$$ plus the rank of $$k$$ within the right subtree.

The time complexity is $$O(\lg n)$$ for an $$n$$-node order-statistic tree, as we traverse at most one path from root to leaf.
