---
title:       Exercise 9.3-5
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "order statistics, median subroutine, selection algorithm, partitioning"
description: "Suppose that you have a "black-box" worst-case linear-time median subroutine. Give a simple, linear-time algorithm that solves the selection problem for an arbitrary order statistic."
---

> Suppose that you have a "black-box" worst-case linear-time median subroutine. Give a simple, linear-time algorithm that solves the selection problem for an arbitrary order statistic.

With a linear-time median subroutine, we can adapt the $$\textsc{Randomized-Select}$$ approach but replace random pivot selection with deterministic median selection to guarantee good partitions.

{% capture code %}
Select-With-Median(A, p, r, i)
    if p == r
        return A[p]
    x = Black-Box-Median(A, p, r)
    q = Partition-Around(A, p, r, x)
    k = q - p + 1
    if i == k
        return A[q]
    elseif i < k
        return Select-With-Median(A, p, q - 1, i)
    else
        return Select-With-Median(A, q + 1, r, i - k)
{% endcapture %}
{% include clrs_code.html %}

Here, $$\textsc{Black-Box-Median}(A, p, r)$$ returns the median of $$A[p \ldots r]$$ in $$O(n)$$ time, and $$\textsc{Partition-Around}(A, p, r, x)$$ partitions the array around the value $$x$$ in $$O(n)$$ time.

Since the median splits the array into two parts of size at most $$\lceil n/2 \rceil$$ each, the recurrence is:

$$\begin{align*}
T(n) &= T(n/2) + O(n) + O(n) \\
&= T(n/2) + O(n)
\end{align*}$$

The first $$O(n)$$ term is for finding the median, and the second is for partitioning. By the Master Theorem (case 3) or by direct analysis:

$$\begin{align*}
T(n) &= O(n) + O(n/2) + O(n/4) + \cdots \\
&= O(n(1 + 1/2 + 1/4 + \cdots)) \\
&= O(n)
\end{align*}$$

Therefore, with a black-box linear-time median subroutine, we can solve the selection problem for any order statistic in $$O(n)$$ worst-case time. This is essentially what the $$\textsc{Select}$$ algorithm does internally, but here we're using the median subroutine as a building block rather than implementing the median-of-medians technique ourselves.