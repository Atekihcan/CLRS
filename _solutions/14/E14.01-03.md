---
title:       Exercise 14.1-3
published:   2025-11-16 00:00
modified:    2025-11-16 00:00
keywords:    "order-statistic tree, iterative algorithm, tree search"
description: "Write a nonrecursive version of OS-SELECT."
---

> Write a nonrecursive version of $$\textsc{OS-Select}$$.

The recursive version of $$\textsc{OS-Select}$$ can be naturally converted to an iterative version by using a loop instead of recursive calls. The key idea remains the same: at each node, compute its rank within the current subtree and decide whether to go left, go right, or return the current node.

{% capture code %}
OS-Select-Iterative(x, i)
    while true
        r = x.left.size + 1
        if i == r
            return x
        elseif i < r
            x = x.left
        else
            x = x.right
            i = i - r
{% endcapture %}
{% include clrs_code.html title="OS-Select-Iterative(x, i)" %}

The algorithm works by maintaining the invariant that we are always searching for the $$i$$th smallest element in the subtree rooted at $$x$$.

When we move to the left subtree (line 7), the $$i$$th element we seek remains the $$i$$th element in that subtree. When we move to the right subtree (line 9), we must adjust $$i$$ by subtracting $$r$$, the number of elements in the left subtree and at the current node. This is because those $$r$$ elements are all smaller than any element in the right subtree, so the $$i$$th smallest overall becomes the $$(i - r)$$th smallest in the right subtree.

The time complexity remains $$O(\lg n)$$ for an $$n$$-node order-statistic tree, as we traverse at most one path from the root to a leaf. The iterative version has the advantage of avoiding function call overhead and potentially using less stack space.
