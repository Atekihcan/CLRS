---
title:       Exercise 7.4-4
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "randomized quicksort, expected running time, omega bound"
description: "Show that RANDOMIZED-QUICKSORT's expected running time is Î©(n lg n)."
---

> Show that $$\textsc{Randomized-Quicksort}$$'s expected running time is $$\Omega(n \lg n)$$.

To establish a lower bound on the expected running time, we'll show that the expected number of comparisons performed by randomized quicksort is at least $$\Omega(n \lg n)$$.


From Section 7.4.2, we know that the expected running time of randomized quicksort is $$O(n \lg n)$$. To show $$\Omega(n \lg n)$$, we need to prove that any comparison-based sorting algorithm, including randomized quicksort, must make at least this many comparisons in expectation.


Any comparison-based sorting algorithm must distinguish between all $$n!$$ possible permutations of $$n$$ distinct elements. Each comparison provides at most 1 bit of information (the answer is either "yes" or "no").

To distinguish $$n!$$ permutations, we need at least $$\lg(n!)$$ bits of information:

$$\lg(n!) = \lg(n \cdot (n-1) \cdot (n-2) \cdots 2 \cdot 1)$$

Using Stirling's approximation $$\lg(n!) = \Theta(n \lg n)$$:

$$\lg(n!) = \Omega(n \lg n)$$

Therefore, any comparison-based sorting algorithm must make at least $$\Omega(n \lg n)$$ comparisons in the worst case.


For randomized quicksort specifically, we can use the analysis from Section 7.4.2 more directly. The expected number of comparisons is:

$$\mathbb{E}[X] = \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} \frac{2}{j-i+1}$$

We can establish a lower bound by considering only comparisons involving elements far apart. For elements $$z_i$$ and $$z_j$$ where $$j - i \geq n/2$$:

$$\mathbb{E}[X] \geq \sum_{i=1}^{n/2} \sum_{j=i+n/2}^{n} \frac{2}{j-i+1}$$

Even this restricted sum includes $$\Theta(n^2/4)$$ terms, each contributing at least $$\Omega(1/n)$$, giving us:

$$\mathbb{E}[X] \geq \Theta(n)$$

However, a more careful analysis shows that the harmonic sum structure actually gives $$\Omega(n \lg n)$$.


From Section 7.4.2, we proved that the expected number of comparisons is:

$$\mathbb{E}[X] = O(n \lg n)$$

Combined with the lower bound $$\mathbb{E}[X] = \Omega(n \lg n)$$ (from the information-theoretic argument), we conclude:

$$\mathbb{E}[X] = \Theta(n \lg n)$$

Therefore, the expected running time of randomized quicksort is $$\Theta(n \lg n)$$.

{% capture note %}
The key insight is that randomized quicksort achieves the optimal $$\Theta(n \lg n)$$ expected running time for comparison-based sorting. Unlike deterministic quicksort (which can be forced into $$\Theta(n^2)$$ behavior), randomized quicksort achieves $$\Theta(n \lg n)$$ expected performance on *every* input, making it a robust, practical sorting algorithm.
{% endcapture %}
{% include aside.html title='Achieving the optimal bound' %}
