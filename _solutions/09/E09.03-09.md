---
title:       Exercise 9.3-9
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "median, optimization, pipeline, linear time, order statistics"
description: "Professor Olay is consulting for an oil company, which is planning a large pipeline running east to west through an oil field of n wells. The company wants to connect a spur pipeline from each well directly to the main pipeline along a shortest route (either north or south), as shown in Figure 9.2. Given the x- and y-coordinates of the wells, how should the professor pick the optimal location of the main pipeline, which would be the one that minimizes the total length of the spurs? Show how to determine the optimal location in linear time."
---

> Professor Olay is consulting for an oil company, which is planning a large pipeline running east to west through an oil field of $$n$$ wells. The company wants to connect a spur pipeline from each well directly to the main pipeline along a shortest route (either north or south), as shown in Figure 9.2. Given the $$x$$- and $$y$$-coordinates of the wells, how should the professor pick the optimal location of the main pipeline, which would be the one that minimizes the total length of the spurs? Show how to determine the optimal location in linear time.

Since the main pipeline runs east to west (horizontally) and each spur runs north or south (vertically), the $$x$$-coordinates of the wells do not affect the spur lengths. If the pipeline is placed at horizontal position $$y = c$$, the total spur length is $$\sum_{i=1}^{n} |y_i - c|$$, where $$y_i$$ is the $$y$$-coordinate of well $$i$$.

This is precisely the problem of finding the value $$c$$ that minimizes the sum of absolute deviations from a set of points. The optimal solution is to place the pipeline at the median of the $$y$$-coordinates.

**Why the median is optimal:**

Consider moving the pipeline from some position $$c$$ by a small amount $$\epsilon$$. If there are $$k$$ wells below the pipeline and $$n - k$$ wells above it, the change in total spur length is approximately $$(n - k) \epsilon - k \epsilon = (n - 2k) \epsilon$$.

This derivative is zero when $$k = n/2$$, which occurs when the pipeline is at the median. For $$c$$ less than the median ($$k < n/2$$), moving up decreases total length. For $$c$$ greater than the median ($$k > n/2$$), moving down decreases total length. Therefore, the median minimizes the total spur length.

More formally, suppose $$c$$ is not at the median. If $$c$$ is below the median, there are more wells above $$c$$ than below. Moving $$c$$ up by a small amount decreases the distance to more wells than it increases, reducing total length. The same argument applies when $$c$$ is above the median.

**Algorithm:**

{% capture code %}
Optimal-Pipeline-Location(wells)
    n = wells.length
    // Extract y-coordinates
    for i = 1 to n
        Y[i] = wells[i].y

    // Find median y-coordinate
    median-y = Select(Y, 1, n, ⌊(n + 1) / 2⌋)

    return median-y
{% endcapture %}
{% include clrs_code.html %}

Using the $$\textsc{Select}$$ algorithm, we find the median in $$O(n)$$ time. The $$x$$-coordinates are irrelevant to the optimization, so we only need to process the $$y$$-coordinates.

**Example:** For wells at $$y$$-coordinates $$\{3, 1, 7, 2, 5\}$$, the median is 3, so place the pipeline at $$y = 3$$. Total spur length is $$|3-3| + |1-3| + |7-3| + |2-3| + |5-3| = 0 + 2 + 4 + 1 + 2 = 9$$.