<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- Legacy meta -->
    <meta name="description" content="We can express insertion sort as a recursive procedure as follows. In order to sort A[1..n], we recursively sort A[1..n−1] and then insert A[n] into the sorted array A[1..n−1]. Write a recurrence for the running time of this recursive version of insertion sort."/>
    <meta name="keywords" content="CLRS, solutions, algorithms, Cormen, Insertion Sort, Recursive Insertion Sort"/>

    <!--Schema-->
    <link rel="author" href="Atekihcan">
    <link rel="publisher" href="https://atekihcan.github.io">
    <meta itemprop="name" content="CLRS Solutions | Exercise 2.3-4 | Getting Started"/>
    <meta itemprop="description" content="We can express insertion sort as a recursive procedure as follows. In order to sort A[1..n], we recursively sort A[1..n−1] and then insert A[n] into the sorted array A[1..n−1]. Write a recurrence for the running time of this recursive version of insertion sort."/>

    <!-- OpenGraph -->
    <meta property="og:title" content="CLRS Solutions | Exercise 2.3-4 | Getting Started" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://atekihcan.github.io/CLRS/02/E02.03-04/" />
    <meta property="og:image" content="/CLRS/assets/img/02/2.3-4.jpg" />
    <meta property="og:description" content="We can express insertion sort as a recursive procedure as follows. In order to sort A[1..n], we recursively sort A[1..n−1] and then insert A[n] into the sorted array A[1..n−1]. Write a recurrence for the running time of this recursive version of insertion sort." />

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "CLRS Solutions | Exercise 2.3-4 | Getting Started",
        "image": [
            "/CLRS/assets/img/02/2.3-4.jpg"
        ],
        "datePublished": "2012-08-22T22:15:00+00:00",
        "dateModified": "2020-10-04T20:30:00+00:00",
        "author": {
            "@type": "Person",
            "name": "Atekihcan"
        }
    }
    </script>
    
    <title>CLRS Solutions | Exercise 2.3-4 | Getting Started</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="/CLRS/assets/img/favicon.png">

    <!-- Normalize reset -->
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/normalize.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Katex -->
    <link rel="stylesheet" href="/CLRS/assets/katex/katex.min.css" >
    <script defer src="/CLRS/assets/katex/katex.min.js" ></script>
    <script defer src="/CLRS/assets/katex/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {trust: true});"></script>

    <!-- Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-57470252-4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-57470252-4', {
            cookie_domain: 'https://atekihcan.github.io',
            cookie_flags: 'SameSite=None;Secure'
        });
    </script>

    <!-- Load site specific stuff at last -->
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/site.css">
    <link media="all" rel="stylesheet" href="/CLRS/assets/css/syntax_highlight.css">

    <script defer src="/CLRS/assets/js/site.js" ></script>
</head>
    <body class="site-body">
        <header class="site-header">
    <nav>
        <i class="fa fa-database"></i>&nbsp;&nbsp;<a href="/CLRS/">Solutions for CLRS</a>&nbsp;&nbsp;<i class="fa fa-database"></i>
    </nav>
    <h1 class="page-title">
        Exercise 2.3-4
    </h1>
</header>
        <main class="site-main">
            <article>
    <div class="article-content">
        <blockquote>
  <p>We can express insertion sort as a recursive procedure as follows. In order to sort \(A[1..n]\), we recursively sort \(A[1..n-1]\) and then insert \(A[n]\) into the sorted array \(A[1..n-1]\). Write a recurrence for the running time of this recursive version of insertion sort.</p>
</blockquote>

<p>There are two steps in this recursive sorting algorithm:</p>

<ol>
  <li>Sort the sub-array \(A[1..n-1]\)</li>
  <li>Insert \(A[n]\) into the sorted sub-array from step 1 in proper position</li>
</ol>

<p>For \(n = 1\), step 1 doesn’t take any time as the sub-array is an empty array and step 2 takes constant time, i.e. the algorithm runs in \(\Theta(1)\) time.</p>

<p>For \(n &gt; 1\), step 1 again calls for the recursion for \(n - 1\) and step 2 runs in \(\Theta(n)\) time.</p>

<p>So, we can write the recurrence as:</p>

\[T(n) = \begin {cases}
    \Theta(1)               &amp; \text { if } n = 1, \\
    T(n - 1) + \Theta(n)    &amp; \text { if } n &gt; 1
\end {cases}\]

<script>
     function showSupportMessage() {
          var placeholders = document.getElementsByClassName("support-message");
          console.log(placeholders);
          for (var i = 0; i < placeholders.length; i++) {
               placeholders[i].style.display = "block";
          }
     }
</script>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" onerror="showSupportMessage();"></script>

<!-- Display_Horizontal -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7476503486911097" data-ad-slot="5416910574" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<aside class="support-message">
     <header>Looks like you hate ads as much as I do!</header>
     <section>
     <p>And there is nothing wrong with that! However, the ads on this website are unobtrusive and used as section divider. It'd be great if you can whitelist this website from your adblocker and give it a try. If you don't like the experience, you can always turn it back on.</p>
     
     <p>Either way try to leave a message in the <a href="#disqus_thread">comments section</a> to show some support.</p>
     </section>
</aside>

<h3 id="additional-analysis">Additional Analysis</h3>

<p>Although it has not been asked in the problem statement, let us try to solve the recurrence for practice the same way it was done for \(\textsc {Insertion-Sort}\) in the book or for \(\textsc {Selection-Sort}\) in <a href="/CLRS/02/E02.02-02/">Exercise 2.2-2</a>.</p>

<p>Let us first write the pseudocode for auxiliary procedure required to insert \(A[n]\) into the sorted array as follows …</p>

<div class="latex-pseudo-code">$$\textsc {Insert }(A, k)$$$$\begin{aligned}1&amp; \quad  key=A[k] \\2&amp; \quad  index=k-1 \\3&amp; \quad  \textbf {while }index&gt;0\text { and }A[index]&gt;key \\4&amp; \quad \qquad  A[index+1]=A[index] \\5&amp; \quad \qquad  index=index-1 \\6&amp; \quad  A[index+1]=key \\\end{aligned}$$</div>

<p>And recursive insertion sort as follows …</p>

<div class="latex-pseudo-code">$$\textsc {Recurse-Insertion-Sort }(A, n)$$$$\begin{aligned}1&amp; \quad  \textbf {if }n&gt;1 \\2&amp; \quad \qquad  \textsc {Recurse-Insertion-Sort}(A,\,n-1) \\3&amp; \quad \qquad  \textsc {Insert}(A,\,n) \\\end{aligned}$$</div>

<h4 id="intuitive-solution">Intuitive Solution</h4>

<p>As it is probably evident from the pseudocode, to insert the an element in a sorted sorted array in its’ rightful position, we’ll need to shift <em>some</em> of the elements to the right to make space for the new element.</p>

<p>In the worst case, when the new element is smaller than all elements in the array, all the \(n\) elements has to be shifted. Which means it’ll be \(\Theta(n)\) operation.</p>

<p>In the average case, we can assume the new element will smaller than half of the elements and larger than the other half. Which means we will need to shift \(n/2\) elements, which is again a \(\Theta(n)\) operation.</p>

<p>And this shifting has to be done for all of the \(n\) elements one by one while recursing. Which makes the complete algorithm run at \(n \times \Theta(n) = \Theta(n^2)\).</p>

<p>An exhaustive calculation is provided below for the sake of completeness.</p>

<script>
     function showSupportMessage() {
          var placeholders = document.getElementsByClassName("support-message");
          console.log(placeholders);
          for (var i = 0; i < placeholders.length; i++) {
               placeholders[i].style.display = "block";
          }
     }
</script>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" onerror="showSupportMessage();"></script>

<!-- Display_Horizontal -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7476503486911097" data-ad-slot="5416910574" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<aside class="support-message">
     <header>Looks like you hate ads as much as I do!</header>
     <section>
     <p>And there is nothing wrong with that! However, the ads on this website are unobtrusive and used as section divider. It'd be great if you can whitelist this website from your adblocker and give it a try. If you don't like the experience, you can always turn it back on.</p>
     
     <p>Either way try to leave a message in the <a href="#disqus_thread">comments section</a> to show some support.</p>
     </section>
</aside>

<h4 id="exhaustive-proof">Exhaustive Proof</h4>

<p>Let us assume that for \(n = 1\), \(T(n) = c_1\), where \(c_1\) is some constant. And on average for \(n &gt; 1\), inserting an element in its proper position in a sorted array requires shifting half of the elements (as explained above), i.e. \(c_2n/2 + c_3\) time (\(c_2n/2\) for shifting the elements and \(c_3\) for inserting the element).</p>

<p>So, we can rewrite the recurrence as:</p>

\[T(n) = \begin {cases}
    c_1                              &amp; \text { if } n = 1, \\
    T(n - 1) + c_2 \frac {(n - 1)} 2 + c_3    &amp; \text { if } n &gt; 1
\end {cases}\]

<p>So for any general \(n &gt; 1\),</p>

\[\begin {aligned}
T(n) &amp; = T(n - 1) + c_2 \frac {(n - 1)} 2 + c_3 \\
     &amp; = \left( T(n - 2) + c_2 \frac {(n - 2)} 2 + c_3 \right) + c_2 \frac {(n - 1)} 2 + c_3 \\
     &amp; = T(1) + \cdots + \left( c_2 \frac {(n - 2)} 2 + c_3 \right) + \left( c_2 \frac {(n - 1)} 2 + c_3 \right) \\
     &amp; = c_1 + \frac {c_2} 2 \left(1 + 2 + \cdot \cdot \cdot + (n - 1)\right) + c_3(n - 1) \\
     &amp; = c_1 + \frac {c_2} 2 \cdot \frac {n(n - 1)} 2 + c_3(n - 1) \\
     &amp; = \Theta(n^2)
\end {aligned}\]

    </div>
    <hr class="solid"/>
    <div class="article-footer">
        <div class="article-footer-message">
    <span style="font-size: 0.8em;">If you have any question or suggestion or you have found any error in this solution, please leave a comment below.</span>
</div>
        <div class="article-nav">
    <div class="article-nav-left">
        
            <a href="/CLRS/02/E02.03-03/">
                <i class="fa fa-2x fa-arrow-left"></i>
            </a>
            <span><strong>E 2.3-3</strong></span>
        
    </div>
    <div class="article-nav-middle">
        <a href="/CLRS/">
            <strong>Solution Index</strong>
        </a>
    </div>
    <div class="article-nav-right">
        
            <span><strong>E 2.3-5</strong></span>
            <a href="/CLRS/02/E02.03-05/">
                <i class="fa fa-2x fa-arrow-right"></i>
            </a>
        
    </div>
</div>



<script>
     function showSupportMessage() {
          var placeholders = document.getElementsByClassName("support-message");
          console.log(placeholders);
          for (var i = 0; i < placeholders.length; i++) {
               placeholders[i].style.display = "block";
          }
     }
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" onerror="showSupportMessage();"></script>

<!-- Display_Horizontal -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-7476503486911097"
     data-ad-slot="5416910574"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<aside class="support-message">
     <header>Looks like you hate ads as much as I do!</header>
     <section>
     <p>And there is nothing wrong with that! However, the ads on this website are unobtrusive and used as section divider. It'd be great if you can whitelist this website from your adblocker and give it a try. If you don't like the experience, you can always turn it back on.</p>
     
     <p>Either way try to leave a message in the <a href="#disqus_thread">comments section</a> to show some support.</p>
     </section>
</aside>

    </div>
</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_observer = new IntersectionObserver(function (entries) {
        // comments section reached
        // start loading Disqus now
        if (entries[0].isIntersecting) {
            var disqus_shortname = 'atekihcan';
            var disqus_identifier = '/CLRS/02/E02.03-04/';
            var disqus_title = 'Exercise 2.3-4';
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();

            // once executed, stop observing
            disqus_observer.disconnect();
        }
    }, {threshold: [0]});
    disqus_observer.observe(document.querySelector("#disqus_thread"));
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
        </main>
        <footer class="site-footer">
    <div>
        &copy; Atekihcan 2007 - 2023
    </div>
</footer>

<script>
    // Left align KaTeX for pseudo codes
    document.addEventListener("DOMContentLoaded", function() { 
        var docs = document.querySelectorAll('.latex-pseudo-code > span > span');
        for (var i = 0; i < docs.length; i++) {
            docs[i].classList.add('fleqn');
        }
    });
</script>

    </body>
</html>