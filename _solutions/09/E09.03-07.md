---
title:       Exercise 9.3-7
published:   2025-11-16 10:00
modified:    2025-11-16 10:00
keywords:    "median, order statistics, closest elements, selection algorithm"
description: "Describe an O(n)-time algorithm that, given a set S of n distinct numbers and a positive integer k ≤ n, determines the k numbers in S that are closest to the median of S."
---

> Describe an $$O(n)$$-time algorithm that, given a set $$S$$ of $$n$$ distinct numbers and a positive integer $$k \le n$$, determines the $$k$$ numbers in $$S$$ that are closest to the median of $$S$$.

The key insight is that the $$k$$ closest numbers to the median form a contiguous block in the sorted order, centered around the median. We can find these elements without fully sorting by using selection and partitioning.

First, find the median $$m$$ of $$S$$ in $$O(n)$$ time using $$\textsc{Select}$$. Then create a new array $$D$$ where $$D[i] = |S[i] - m|$$ represents each element's distance from the median. The $$k$$ closest elements are those with the $$k$$ smallest distances.

{% capture code %}
K-Closest-To-Median(S, k)
    n = S.length
    m = Select(S, 1, n, ⌊(n + 1) / 2⌋)

    // Create array of distances from median
    for i = 1 to n
        D[i] = |S[i] - m|

    // Find the kth smallest distance
    d = Select(D, 1, n, k)

    // Partition around this distance
    Partition-Around(D, 1, n, d)

    // Collect elements with distance ≤ d
    result = {}
    for i = 1 to n
        if D[i] ≤ d
            add S[i] to result

    return first k elements from result
{% endcapture %}
{% include clrs_code.html %}

**Analysis:**

1. Finding the median takes $$O(n)$$ time
2. Creating the distance array takes $$O(n)$$ time
3. Finding the $$k$$th smallest distance takes $$O(n)$$ time
4. Partitioning takes $$O(n)$$ time
5. Collecting results takes $$O(n)$$ time

The total time is $$O(n)$$.

{% capture note %}
There's a subtle issue: if multiple elements have the same distance $$d$$ from the median, we might collect more than $$k$$ elements in step 4. To handle this precisely, after partitioning, we take all elements with distance strictly less than $$d$$, then add elements with distance exactly $$d$$ until we have exactly $$k$$ elements total. This doesn't change the asymptotic complexity.
{% endcapture %}
{% include aside.html title='Handling Ties' %}

For example, if $$S = \{1, 5, 3, 7, 9, 2, 4\}$$ and $$k = 4$$, the median is 4, the distances are $$\{3, 1, 1, 3, 5, 2, 0\}$$, and the 4 closest elements are $$\{4, 3, 5, 2\}$$ with distances $$\{0, 1, 1, 2\}$$.